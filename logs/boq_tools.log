2025-06-23 23:52:36,388 [INFO] root: Logging system initialized
2025-06-23 23:52:36,389 [INFO] root: Configuration loaded successfully
2025-06-23 23:52:36,389 [INFO] core.sheet_classifier: Sheet Classifier initialized
2025-06-23 23:52:36,391 [INFO] core.column_mapper: Loaded canonical mappings from C:\Users\Admin\AppData\Roaming\BOQ-TOOLS\canonical_mappings.json
2025-06-23 23:52:36,391 [INFO] core.column_mapper: Column Mapper initialized
2025-06-23 23:52:36,391 [INFO] core.row_classifier: Row Classifier initialized
2025-06-23 23:52:36,391 [INFO] core.validator: Data Validator initialized
2025-06-23 23:52:36,392 [INFO] core.mapping_generator: Mapping Generator initialized
2025-06-23 23:52:36,392 [INFO] utils.export: ExcelExporter initialized.
2025-06-23 23:52:36,392 [INFO] root: Core components initialized successfully
2025-06-23 23:52:36,393 [INFO] root: Settings loaded successfully
2025-06-23 23:52:36,393 [INFO] root: BOQ Tools v1.0.0 initialized successfully
2025-06-23 23:52:40,937 [INFO] core.file_processor: Detected file format: xlsx
2025-06-23 23:52:41,450 [INFO] core.file_processor: Successfully loaded Excel file: GRE.EEC.F.27.IT.P.18371.00.098.02 - PONTESTURA 9,69 MW_cBOQ PV_rev 9 giu (ENEMEK).xlsx
2025-06-23 23:52:41,451 [INFO] core.file_processor: Total sheets: 35
2025-06-23 23:52:41,452 [INFO] core.file_processor: Found 12 visible sheets out of 35 total
2025-06-23 23:52:46,547 [INFO] root: Processing file: C:\Users\Admin\Documents\GitHub\BOQ-TOOLS\examples\GRE.EEC.F.27.IT.P.18371.00.098.02 - PONTESTURA 9,69 MW_cBOQ PV_rev 9 giu (ENEMEK).xlsx
2025-06-23 23:52:46,547 [INFO] core.file_processor: Detected file format: xlsx
2025-06-23 23:52:47,067 [INFO] core.file_processor: Successfully loaded Excel file: GRE.EEC.F.27.IT.P.18371.00.098.02 - PONTESTURA 9,69 MW_cBOQ PV_rev 9 giu (ENEMEK).xlsx
2025-06-23 23:52:47,067 [INFO] core.file_processor: Total sheets: 35
2025-06-23 23:52:47,068 [INFO] core.file_processor: Found 12 visible sheets out of 35 total
2025-06-23 23:52:47,068 [INFO] core.file_processor: Found 12 visible sheets out of 35 total
2025-06-23 23:52:47,200 [DEBUG] core.sheet_classifier: Classifying sheet: Miscellaneous
2025-06-23 23:52:47,221 [DEBUG] core.sheet_classifier: Sheet 'Miscellaneous' classified as mixed with confidence 0.69
2025-06-23 23:52:47,222 [DEBUG] core.sheet_classifier: Classifying sheet: Civil Works
2025-06-23 23:52:47,274 [DEBUG] core.sheet_classifier: Sheet 'Civil Works' classified as mixed with confidence 0.67
2025-06-23 23:52:47,275 [DEBUG] core.sheet_classifier: Classifying sheet: ACCESS ROADS
2025-06-23 23:52:47,300 [DEBUG] core.sheet_classifier: Sheet 'ACCESS ROADS' classified as mixed with confidence 0.47
2025-06-23 23:52:47,300 [DEBUG] core.sheet_classifier: Classifying sheet: EMBOP_SI
2025-06-23 23:52:47,356 [DEBUG] core.sheet_classifier: Sheet 'EMBOP_SI' classified as line_items with confidence 0.75
2025-06-23 23:52:47,356 [DEBUG] core.sheet_classifier: Classifying sheet: EMBOP-TRK Install.
2025-06-23 23:52:47,363 [DEBUG] core.sheet_classifier: Sheet 'EMBOP-TRK Install.' classified as mixed with confidence 0.69
2025-06-23 23:52:47,363 [DEBUG] core.sheet_classifier: Classifying sheet: Spare Parts
2025-06-23 23:52:47,366 [DEBUG] core.sheet_classifier: Sheet 'Spare Parts' classified as mixed with confidence 0.48
2025-06-23 23:52:47,366 [DEBUG] core.sheet_classifier: Classifying sheet: HSE (ITA ESP)
2025-06-23 23:52:47,370 [DEBUG] core.sheet_classifier: Sheet 'HSE (ITA ESP)' classified as mixed with confidence 0.63
2025-06-23 23:52:47,370 [DEBUG] core.sheet_classifier: Classifying sheet: SUS
2025-06-23 23:52:47,372 [DEBUG] core.sheet_classifier: Sheet 'SUS' classified as mixed with confidence 0.52
2025-06-23 23:52:47,372 [DEBUG] core.sheet_classifier: Classifying sheet: Security
2025-06-23 23:52:47,374 [DEBUG] core.sheet_classifier: Sheet 'Security' classified as mixed with confidence 0.44
2025-06-23 23:52:47,374 [INFO] core.column_mapper: Processing sheet mapping for 107 rows
2025-06-23 23:52:47,375 [DEBUG] core.column_mapper: Searching for header row in 107 rows
2025-06-23 23:52:47,390 [DEBUG] core.column_mapper: Header row candidates:
2025-06-23 23:52:47,390 [DEBUG] core.column_mapper: Row 1 (_detect_by_merged_cells): confidence=0.35, headers=['', 'ENGINEERING SERVICES', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 19/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,391 [DEBUG] core.column_mapper: Row 2 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 1 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,391 [DEBUG] core.column_mapper: Row 3 (_detect_by_keywords): confidence=0.93, headers=['', 'WBS', 'Reference Document', 'Code', 'DESCRIPTION', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=["Keyword matches: 'Reference Document' matches code, 'Reference Document' matches code, 'Code' matches code", 'Multiple keyword matches: 18 keywords found']
2025-06-23 23:52:47,391 [DEBUG] core.column_mapper: Row 3 (_detect_by_data_patterns): confidence=0.70, headers=['', 'WBS', 'Reference Document', 'Code', 'DESCRIPTION', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,391 [DEBUG] core.column_mapper: Row 3 (_detect_by_merged_cells): confidence=0.35, headers=['', 'WBS', 'Reference Document', 'Code', 'DESCRIPTION', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=['Potential merged cells: 7/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,392 [DEBUG] core.column_mapper: Row 4 (_detect_by_keywords): confidence=0.77, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=["Keyword matches: 'Main equipment used for works, for each item' matches description, 'Main equipment used for works, for each item' matches description, 'Description of supplied materials, for each item' matches description", 'Multiple keyword matches: 4 keywords found']
2025-06-23 23:52:47,392 [DEBUG] core.column_mapper: Row 4 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,392 [DEBUG] core.column_mapper: Row 4 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=['Potential merged cells: 11/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,392 [DEBUG] core.column_mapper: Row 5 (_detect_by_keywords): confidence=0.51, headers=['', 'GENERAL COSTS\xa0', '', '', '', 'Total Mandatory', '\xa0', '\xa0', '\xa0', '', '', '', '', '', '', '', '', '', '154492.67449563646', '\xa0'], reasoning=["Keyword matches: 'GENERAL COSTS\xa0' matches total_price, 'Total Mandatory' matches total_price, 'Total Mandatory' matches classification"]
2025-06-23 23:52:47,392 [DEBUG] core.column_mapper: Row 5 (_detect_by_data_patterns): confidence=0.70, headers=['', 'GENERAL COSTS\xa0', '', '', '', 'Total Mandatory', '\xa0', '\xa0', '\xa0', '', '', '', '', '', '', '', '', '', '154492.67449563646', '\xa0'], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,393 [DEBUG] core.column_mapper: Row 5 (_detect_by_merged_cells): confidence=0.35, headers=['', 'GENERAL COSTS\xa0', '', '', '', 'Total Mandatory', '\xa0', '\xa0', '\xa0', '', '', '', '', '', '', '', '', '', '154492.67449563646', '\xa0'], reasoning=['Potential merged cells: 17/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,393 [DEBUG] core.column_mapper: Row 6 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', 'Total Option', '\xa0', '\xa0', '\xa0', '', '', '', '', '', '', '', '', '', '0', '\xa0'], reasoning=['Subsequent rows contain numeric data in 1 rows', 'Currency patterns detected in 1 columns']
2025-06-23 23:52:47,393 [DEBUG] core.column_mapper: Row 6 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', 'Total Option', '\xa0', '\xa0', '\xa0', '', '', '', '', '', '', '', '', '', '0', '\xa0'], reasoning=['Potential merged cells: 18/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,393 [DEBUG] core.column_mapper: Row 7 (_detect_by_data_patterns): confidence=0.70, headers=['', 'Bank Guarantee', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-06-23 23:52:47,394 [DEBUG] core.column_mapper: Row 7 (_detect_by_merged_cells): confidence=0.35, headers=['', 'Bank Guarantee', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 19/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,394 [DEBUG] core.column_mapper: Row 8 (_detect_by_keywords): confidence=0.38, headers=['', '', 'GRE…..', '', 'Cost of Bank Guarantee (Down Payment, Execution, Warranty - exclusion of FX, Tracker, SI, PCU, TC supply)', 'Mandatory', 'ls', '1', '', '', '0', '', '', '0', '', '115580', '', '115580', '115580', ''], reasoning=["Keyword matches: 'Cost of Bank Guarantee (Down Payment, Execution, Warranty - exclusion of FX, Tracker, SI, PCU, TC supply)' matches total_price, 'Mandatory' matches classification"]
2025-06-23 23:52:47,396 [DEBUG] core.column_mapper: Row 8 (_detect_by_data_patterns): confidence=0.70, headers=['', '', 'GRE…..', '', 'Cost of Bank Guarantee (Down Payment, Execution, Warranty - exclusion of FX, Tracker, SI, PCU, TC supply)', 'Mandatory', 'ls', '1', '', '', '0', '', '', '0', '', '115580', '', '115580', '115580', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-06-23 23:52:47,396 [DEBUG] core.column_mapper: Row 8 (_detect_by_merged_cells): confidence=0.35, headers=['', '', 'GRE…..', '', 'Cost of Bank Guarantee (Down Payment, Execution, Warranty - exclusion of FX, Tracker, SI, PCU, TC supply)', 'Mandatory', 'ls', '1', '', '', '0', '', '', '0', '', '115580', '', '115580', '115580', ''], reasoning=['Potential merged cells: 10/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,396 [DEBUG] core.column_mapper: Row 9 (_detect_by_data_patterns): confidence=0.70, headers=['', 'PV MODULE CLEANING', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,397 [DEBUG] core.column_mapper: Row 9 (_detect_by_merged_cells): confidence=0.35, headers=['', 'PV MODULE CLEANING', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 19/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,397 [INFO] core.column_mapper: Header row found at index 3 with confidence 0.93
2025-06-23 23:52:47,397 [DEBUG] core.column_mapper: Mapping 20 columns to BOQ types (robust)
2025-06-23 23:52:47,399 [DEBUG] core.column_mapper: Demoted column 'WBS' from description to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,399 [DEBUG] core.column_mapper: Demoted column 'Reference Document' from code to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,400 [DEBUG] core.column_mapper: Demoted column 'SCOPE' from description to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,400 [DEBUG] core.column_mapper: Demoted column 'Labour' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,400 [DEBUG] core.column_mapper: Demoted column 'Equipment' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,401 [DEBUG] core.column_mapper: Demoted column 'SUPPLY' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,401 [DEBUG] core.column_mapper: Demoted column 'Notes' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,402 [DEBUG] core.column_mapper: Overall mapping confidence: 0.63
2025-06-23 23:52:47,402 [INFO] core.column_mapper: Mapping completed: 13 columns mapped, confidence: 0.63
2025-06-23 23:52:47,402 [INFO] core.column_mapper: Processing sheet mapping for 205 rows
2025-06-23 23:52:47,402 [DEBUG] core.column_mapper: Searching for header row in 205 rows
2025-06-23 23:52:47,405 [DEBUG] core.column_mapper: Header row candidates:
2025-06-23 23:52:47,405 [DEBUG] core.column_mapper: Row 1 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'EXISTING IN THE PROJECT? þ / ¨    ð ', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 37/38 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,405 [DEBUG] core.column_mapper: Row 2 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'True', 'True', 'True', 'True', 'True', 'True', 'True', 'True', 'True', 'True', 'True', 'True', ''], reasoning=['Potential merged cells: 26/38 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,406 [DEBUG] core.column_mapper: Row 3 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', ''], reasoning=['Potential merged cells: 26/38 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,406 [DEBUG] core.column_mapper: Row 5 (_detect_by_merged_cells): confidence=0.35, headers=['', 'CIVIL WORKS', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'AREA 01', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 36/38 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,406 [DEBUG] core.column_mapper: Row 7 (_detect_by_keywords): confidence=0.94, headers=['', 'WBS', 'REFERENCE DOCUMENT', 'CODE', '', '', '', 'ITEM DESCRIPTION', 'UNIT\n(SI)', 'UNIT (IMP.)', 'QUANTITY', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'UNIT\nPRICE', 'TOTAL \nPRICE', 'NOTES', '', '', 'PARCO', 'Subpark 01.2', 'Subpark 01.3', 'Subpark 01.4', 'TC', 'PALI LUCE', 'IR 01.5', 'IR 01.6', 'OTHER 01.1', 'OTHER 01.2', 'OTHER 01.3', 'OTHER 01.4', 'TOTAL'], reasoning=["Keyword matches: 'REFERENCE DOCUMENT' matches code, 'REFERENCE DOCUMENT' matches code, 'CODE' matches code", 'Multiple keyword matches: 16 keywords found']
2025-06-23 23:52:47,406 [DEBUG] core.column_mapper: Row 7 (_detect_by_positional_logic): confidence=0.50, headers=['', 'WBS', 'REFERENCE DOCUMENT', 'CODE', '', '', '', 'ITEM DESCRIPTION', 'UNIT\n(SI)', 'UNIT (IMP.)', 'QUANTITY', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'UNIT\nPRICE', 'TOTAL \nPRICE', 'NOTES', '', '', 'PARCO', 'Subpark 01.2', 'Subpark 01.3', 'Subpark 01.4', 'TC', 'PALI LUCE', 'IR 01.5', 'IR 01.6', 'OTHER 01.1', 'OTHER 01.2', 'OTHER 01.3', 'OTHER 01.4', 'TOTAL'], reasoning=['Right column contains total-like content', 'Middle columns contain quantity/unit content (6 matches)']
2025-06-23 23:52:47,407 [DEBUG] core.column_mapper: Row 7 (_detect_by_merged_cells): confidence=0.35, headers=['', 'WBS', 'REFERENCE DOCUMENT', 'CODE', '', '', '', 'ITEM DESCRIPTION', 'UNIT\n(SI)', 'UNIT (IMP.)', 'QUANTITY', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'UNIT\nPRICE', 'TOTAL \nPRICE', 'NOTES', '', '', 'PARCO', 'Subpark 01.2', 'Subpark 01.3', 'Subpark 01.4', 'TC', 'PALI LUCE', 'IR 01.5', 'IR 01.6', 'OTHER 01.1', 'OTHER 01.2', 'OTHER 01.3', 'OTHER 01.4', 'TOTAL'], reasoning=['Potential merged cells: 12/38 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,407 [DEBUG] core.column_mapper: Row 8 (_detect_by_keywords): confidence=0.73, headers=['', '', '', '', '', '\xa0', '\xa0', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=["Keyword matches: 'Main equipment used for works, for each item' matches description, 'Main equipment used for works, for each item' matches description, 'Description of supplied materials, for each item' matches description", 'Multiple keyword matches: 4 keywords found']
2025-06-23 23:52:47,407 [DEBUG] core.column_mapper: Row 8 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '\xa0', '\xa0', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 29/38 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,407 [DEBUG] core.column_mapper: Row 9 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '', '', 'EARTHWORKS & ROADS', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 37/38 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,407 [INFO] core.column_mapper: Header row found at index 7 with confidence 0.94
2025-06-23 23:52:47,408 [DEBUG] core.column_mapper: Mapping 38 columns to BOQ types (robust)
2025-06-23 23:52:47,414 [DEBUG] core.column_mapper: Demoted column 'WBS' from description to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,414 [DEBUG] core.column_mapper: Demoted column 'REFERENCE DOCUMENT' from code to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,415 [DEBUG] core.column_mapper: Demoted column 'UNIT (IMP.)' from unit to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,416 [DEBUG] core.column_mapper: Demoted column 'Labour' from description to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,416 [DEBUG] core.column_mapper: Demoted column 'Equipment' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,416 [DEBUG] core.column_mapper: Demoted column 'SUPPLY' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,417 [DEBUG] core.column_mapper: Demoted column 'NOTES' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,417 [DEBUG] core.column_mapper: Demoted column 'PARCO' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,417 [DEBUG] core.column_mapper: Demoted column 'Subpark 01.2' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,417 [DEBUG] core.column_mapper: Demoted column 'Subpark 01.3' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,418 [DEBUG] core.column_mapper: Demoted column 'Subpark 01.4' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,418 [DEBUG] core.column_mapper: Demoted column 'TC' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,418 [DEBUG] core.column_mapper: Demoted column 'PALI LUCE' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,418 [DEBUG] core.column_mapper: Demoted column 'IR 01.5' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,418 [DEBUG] core.column_mapper: Demoted column 'IR 01.6' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,419 [DEBUG] core.column_mapper: Demoted column 'OTHER 01.1' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,419 [DEBUG] core.column_mapper: Demoted column 'OTHER 01.2' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,419 [DEBUG] core.column_mapper: Demoted column 'OTHER 01.3' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,419 [DEBUG] core.column_mapper: Demoted column 'OTHER 01.4' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,419 [DEBUG] core.column_mapper: Demoted column 'TOTAL' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,420 [DEBUG] core.column_mapper: Overall mapping confidence: 0.37
2025-06-23 23:52:47,420 [INFO] core.column_mapper: Mapping completed: 26 columns mapped, confidence: 0.37
2025-06-23 23:52:47,420 [INFO] core.column_mapper: Processing sheet mapping for 112 rows
2025-06-23 23:52:47,420 [DEBUG] core.column_mapper: Searching for header row in 112 rows
2025-06-23 23:52:47,422 [DEBUG] core.column_mapper: Header row candidates:
2025-06-23 23:52:47,422 [DEBUG] core.column_mapper: Row 2 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '1022447.0162225312', ''], reasoning=['Potential merged cells: 20/21 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,422 [DEBUG] core.column_mapper: Row 4 (_detect_by_merged_cells): confidence=0.35, headers=['', 'EXTERNAL ACCESS ROADS', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 20/21 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,423 [DEBUG] core.column_mapper: Row 6 (_detect_by_keywords): confidence=0.93, headers=['', 'WBS', 'REFERENCE DOCUMENT', 'CODE', 'DESCRIPTION ITEM', 'SCOPE', 'UNIT\n(SI)', 'UNIT (IMP.)', 'QUANTITY', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'UNIT\nPRICE', 'TOTAL PRICE', 'NOTES'], reasoning=["Keyword matches: 'REFERENCE DOCUMENT' matches code, 'REFERENCE DOCUMENT' matches code, 'CODE' matches code", 'Multiple keyword matches: 17 keywords found']
2025-06-23 23:52:47,423 [DEBUG] core.column_mapper: Row 6 (_detect_by_merged_cells): confidence=0.35, headers=['', 'WBS', 'REFERENCE DOCUMENT', 'CODE', 'DESCRIPTION ITEM', 'SCOPE', 'UNIT\n(SI)', 'UNIT (IMP.)', 'QUANTITY', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'UNIT\nPRICE', 'TOTAL PRICE', 'NOTES'], reasoning=['Potential merged cells: 7/21 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,423 [DEBUG] core.column_mapper: Row 7 (_detect_by_keywords): confidence=0.77, headers=['', '', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=["Keyword matches: 'Main equipment used for works, for each item' matches description, 'Main equipment used for works, for each item' matches description, 'Description of supplied materials, for each item' matches description", 'Multiple keyword matches: 4 keywords found']
2025-06-23 23:52:47,423 [DEBUG] core.column_mapper: Row 7 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=['Potential merged cells: 12/21 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,423 [DEBUG] core.column_mapper: Row 8 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', 'EARTHWORKS & ROADS', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 20/21 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,423 [DEBUG] core.column_mapper: Row 9 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', 'SITE PREPARATION', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 20/21 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,423 [INFO] core.column_mapper: Header row found at index 6 with confidence 0.93
2025-06-23 23:52:47,424 [DEBUG] core.column_mapper: Mapping 21 columns to BOQ types (robust)
2025-06-23 23:52:47,426 [DEBUG] core.column_mapper: Demoted column 'WBS' from description to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,426 [DEBUG] core.column_mapper: Demoted column 'REFERENCE DOCUMENT' from code to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,426 [DEBUG] core.column_mapper: Demoted column 'SCOPE' from description to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,427 [DEBUG] core.column_mapper: Demoted column 'UNIT (IMP.)' from unit to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,427 [DEBUG] core.column_mapper: Demoted column 'Labour' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,427 [DEBUG] core.column_mapper: Demoted column 'Equipment' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,428 [DEBUG] core.column_mapper: Demoted column 'SUPPLY' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,428 [DEBUG] core.column_mapper: Demoted column 'NOTES' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,428 [DEBUG] core.column_mapper: Overall mapping confidence: 0.60
2025-06-23 23:52:47,429 [INFO] core.column_mapper: Mapping completed: 14 columns mapped, confidence: 0.60
2025-06-23 23:52:47,429 [INFO] core.column_mapper: Processing sheet mapping for 263 rows
2025-06-23 23:52:47,429 [DEBUG] core.column_mapper: Searching for header row in 263 rows
2025-06-23 23:52:47,431 [DEBUG] core.column_mapper: Header row candidates:
2025-06-23 23:52:47,431 [DEBUG] core.column_mapper: Row 1 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', 'SOLAR BoP Bill of Quantities', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 21/22 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,432 [DEBUG] core.column_mapper: Row 2 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 1 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,432 [DEBUG] core.column_mapper: Row 3 (_detect_by_keywords): confidence=0.92, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes', '', ''], reasoning=["Keyword matches: 'WBS (per Mr Quyd)\n*da ricostruire struttura' matches total_price, 'Reference Document' matches code, 'Reference Document' matches code", 'Multiple keyword matches: 20 keywords found']
2025-06-23 23:52:47,432 [DEBUG] core.column_mapper: Row 3 (_detect_by_data_patterns): confidence=0.70, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,433 [DEBUG] core.column_mapper: Row 3 (_detect_by_merged_cells): confidence=0.35, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes', '', ''], reasoning=['Potential merged cells: 9/22 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,433 [DEBUG] core.column_mapper: Row 4 (_detect_by_keywords): confidence=0.76, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', '', '', ''], reasoning=["Keyword matches: 'Main equipment used for works, for each item' matches description, 'Main equipment used for works, for each item' matches description, 'Description of supplied materials, for each item' matches description", 'Multiple keyword matches: 4 keywords found']
2025-06-23 23:52:47,433 [DEBUG] core.column_mapper: Row 4 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 3 columns']
2025-06-23 23:52:47,434 [DEBUG] core.column_mapper: Row 4 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', '', '', ''], reasoning=['Potential merged cells: 13/22 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,434 [DEBUG] core.column_mapper: Row 5 (_detect_by_keywords): confidence=0.31, headers=['', ' MV CABLES SUPPLY', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '62001.367050825145', '', '', ''], reasoning=["Keyword matches: 'Total Mandatory' matches total_price, 'Total Mandatory' matches classification"]
2025-06-23 23:52:47,434 [DEBUG] core.column_mapper: Row 5 (_detect_by_data_patterns): confidence=0.70, headers=['', ' MV CABLES SUPPLY', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '62001.367050825145', '', '', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 3 columns']
2025-06-23 23:52:47,434 [DEBUG] core.column_mapper: Row 5 (_detect_by_merged_cells): confidence=0.35, headers=['', ' MV CABLES SUPPLY', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '62001.367050825145', '', '', ''], reasoning=['Potential merged cells: 19/22 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,435 [DEBUG] core.column_mapper: Row 6 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', 'Total Option', '', '', '', '', '', '', '', '', '', '', '', '', '0', '', '', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 3 columns']
2025-06-23 23:52:47,435 [DEBUG] core.column_mapper: Row 6 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', 'Total Option', '', '', '', '', '', '', '', '', '', '', '', '', '0', '', '', ''], reasoning=['Potential merged cells: 20/22 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,435 [DEBUG] core.column_mapper: Row 7 (_detect_by_keywords): confidence=0.31, headers=['', ' MV CABLES INSTALLATION', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '33552.026699096845', '', '', ''], reasoning=["Keyword matches: 'Total Mandatory' matches total_price, 'Total Mandatory' matches classification"]
2025-06-23 23:52:47,435 [DEBUG] core.column_mapper: Row 7 (_detect_by_data_patterns): confidence=0.70, headers=['', ' MV CABLES INSTALLATION', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '33552.026699096845', '', '', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 3 columns']
2025-06-23 23:52:47,435 [DEBUG] core.column_mapper: Row 7 (_detect_by_merged_cells): confidence=0.35, headers=['', ' MV CABLES INSTALLATION', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '33552.026699096845', '', '', ''], reasoning=['Potential merged cells: 19/22 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,435 [DEBUG] core.column_mapper: Row 8 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', 'Total Option', '', '', '', '', '', '', '', '', '', '', '', '', '0', '', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,436 [DEBUG] core.column_mapper: Row 8 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', 'Total Option', '', '', '', '', '', '', '', '', '', '', '', '', '0', '', '', ''], reasoning=['Potential merged cells: 20/22 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,436 [DEBUG] core.column_mapper: Row 9 (_detect_by_keywords): confidence=0.31, headers=['', ' MV CABLES TEST', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '0', '', '', ''], reasoning=["Keyword matches: 'Total Mandatory' matches total_price, 'Total Mandatory' matches classification"]
2025-06-23 23:52:47,436 [DEBUG] core.column_mapper: Row 9 (_detect_by_data_patterns): confidence=0.70, headers=['', ' MV CABLES TEST', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '0', '', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-06-23 23:52:47,436 [DEBUG] core.column_mapper: Row 9 (_detect_by_merged_cells): confidence=0.35, headers=['', ' MV CABLES TEST', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '0', '', '', ''], reasoning=['Potential merged cells: 19/22 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,436 [INFO] core.column_mapper: Header row found at index 3 with confidence 0.92
2025-06-23 23:52:47,436 [DEBUG] core.column_mapper: Mapping 22 columns to BOQ types (robust)
2025-06-23 23:52:47,438 [DEBUG] core.column_mapper: Demoted column 'WBS (per Mr Quyd)
*da ricostruire struttura' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,438 [DEBUG] core.column_mapper: Demoted column 'Reference Document' from code to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,438 [DEBUG] core.column_mapper: Demoted column 'SCOPE' from description to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,438 [DEBUG] core.column_mapper: Demoted column 'Labour' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,438 [DEBUG] core.column_mapper: Demoted column 'Equipment' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,438 [DEBUG] core.column_mapper: Demoted column 'SUPPLY' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,439 [DEBUG] core.column_mapper: Demoted column 'Notes' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,439 [DEBUG] core.column_mapper: Overall mapping confidence: 0.63
2025-06-23 23:52:47,439 [INFO] core.column_mapper: Mapping completed: 13 columns mapped, confidence: 0.63
2025-06-23 23:52:47,439 [INFO] core.column_mapper: Processing sheet mapping for 20 rows
2025-06-23 23:52:47,439 [DEBUG] core.column_mapper: Searching for header row in 20 rows
2025-06-23 23:52:47,446 [DEBUG] core.column_mapper: Header row candidates:
2025-06-23 23:52:47,446 [DEBUG] core.column_mapper: Row 1 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', 'Tracker installation', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 19/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,447 [DEBUG] core.column_mapper: Row 2 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 1 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,447 [DEBUG] core.column_mapper: Row 3 (_detect_by_keywords): confidence=0.93, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=["Keyword matches: 'WBS (per Mr Quyd)\n*da ricostruire struttura' matches total_price, 'Reference Document' matches code, 'Reference Document' matches code", 'Multiple keyword matches: 20 keywords found']
2025-06-23 23:52:47,447 [DEBUG] core.column_mapper: Row 3 (_detect_by_data_patterns): confidence=0.70, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,447 [DEBUG] core.column_mapper: Row 3 (_detect_by_merged_cells): confidence=0.35, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=['Potential merged cells: 7/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,448 [DEBUG] core.column_mapper: Row 4 (_detect_by_keywords): confidence=0.77, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=["Keyword matches: 'Main equipment used for works, for each item' matches description, 'Main equipment used for works, for each item' matches description, 'Description of supplied materials, for each item' matches description", 'Multiple keyword matches: 4 keywords found']
2025-06-23 23:52:47,448 [DEBUG] core.column_mapper: Row 4 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 3 columns']
2025-06-23 23:52:47,448 [DEBUG] core.column_mapper: Row 4 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=['Potential merged cells: 11/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,449 [DEBUG] core.column_mapper: Row 5 (_detect_by_keywords): confidence=0.31, headers=['', 'Tracker installation', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '450547.2343887118', '\xa0'], reasoning=["Keyword matches: 'Total Mandatory' matches total_price, 'Total Mandatory' matches classification"]
2025-06-23 23:52:47,449 [DEBUG] core.column_mapper: Row 5 (_detect_by_data_patterns): confidence=0.70, headers=['', 'Tracker installation', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '450547.2343887118', '\xa0'], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,449 [DEBUG] core.column_mapper: Row 5 (_detect_by_merged_cells): confidence=0.35, headers=['', 'Tracker installation', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '450547.2343887118', '\xa0'], reasoning=['Potential merged cells: 17/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,450 [DEBUG] core.column_mapper: Row 6 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', 'Total Option', '', '', '', '', '', '', '', '', '', '', '', '', '0', '\xa0'], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-06-23 23:52:47,450 [DEBUG] core.column_mapper: Row 6 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', 'Total Option', '', '', '', '', '', '', '', '', '', '', '', '', '0', '\xa0'], reasoning=['Potential merged cells: 18/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,450 [DEBUG] core.column_mapper: Row 7 (_detect_by_keywords): confidence=0.48, headers=['', "INSTALLATION (Include Unitary Price for all the Type of Foundation's Installation)", '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=["Keyword matches: 'INSTALLATION (Include Unitary Price for all the Type of Foundation's Installation)' matches total_price, 'INSTALLATION (Include Unitary Price for all the Type of Foundation's Installation)' matches classification, 'INSTALLATION (Include Unitary Price for all the Type of Foundation's Installation)' matches unit"]
2025-06-23 23:52:47,450 [DEBUG] core.column_mapper: Row 7 (_detect_by_merged_cells): confidence=0.35, headers=['', "INSTALLATION (Include Unitary Price for all the Type of Foundation's Installation)", '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 19/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,451 [DEBUG] core.column_mapper: Row 8 (_detect_by_keywords): confidence=0.62, headers=['', '', 'GRE.EEC.S.21.IT.P.18371.00.127.00 Technical Specification:\nPPP.PVP PV PARK\nPPP.PVP.FPP FIELD PARALLEL\nPPP.PVP.FPP.01 DC PARALLEL\nPPP.PVP.FPP.03 COMMON EQUIPMENT\nPPP.PVP.CBL CABLES\nPPP.PVP.CBL.02 POWER LV\nPPP.PVP.PVS PV SUPPORT STRUCTURES\nPPP.PVP.PVS.02 STRUCTURES IN ELEVATION\nPPP.PVP.PVS.04 MONO-AXIAL TRACKER\nPPP.PVP.WRK.04 ELECTRICAL FIELD BOX ACTIVITIES\nPPP.PVP.OAT.01 FINISHING\n\nTracker Installation-Maintenance Manual', '', 'Complete Electrical Tracker Installation - Engines, Electronic Systems and batteries (LV aux power and I&C cables excluded) [Q]', 'Mandatory', 'N° Trackers', '195', '6.540228591859193', '40', '261.6091436743677', '', '', '0', '', '', '', '261.6091436743677', '51013.78301650171', ''], reasoning=["Keyword matches: 'GRE.EEC.S.21.IT.P.18371.00.127.00 Technical Specification:\nPPP.PVP PV PARK\nPPP.PVP.FPP FIELD PARALLEL\nPPP.PVP.FPP.01 DC PARALLEL\nPPP.PVP.FPP.03 COMMON EQUIPMENT\nPPP.PVP.CBL CABLES\nPPP.PVP.CBL.02 POWER LV\nPPP.PVP.PVS PV SUPPORT STRUCTURES\nPPP.PVP.PVS.02 STRUCTURES IN ELEVATION\nPPP.PVP.PVS.04 MONO-AXIAL TRACKER\nPPP.PVP.WRK.04 ELECTRICAL FIELD BOX ACTIVITIES\nPPP.PVP.OAT.01 FINISHING\n\nTracker Installation-Maintenance Manual' matches description, 'GRE.EEC.S.21.IT.P.18371.00.127.00 Technical Specification:\nPPP.PVP PV PARK\nPPP.PVP.FPP FIELD PARALLEL\nPPP.PVP.FPP.01 DC PARALLEL\nPPP.PVP.FPP.03 COMMON EQUIPMENT\nPPP.PVP.CBL CABLES\nPPP.PVP.CBL.02 POWER LV\nPPP.PVP.PVS PV SUPPORT STRUCTURES\nPPP.PVP.PVS.02 STRUCTURES IN ELEVATION\nPPP.PVP.PVS.04 MONO-AXIAL TRACKER\nPPP.PVP.WRK.04 ELECTRICAL FIELD BOX ACTIVITIES\nPPP.PVP.OAT.01 FINISHING\n\nTracker Installation-Maintenance Manual' matches quantity, 'Mandatory' matches classification"]
2025-06-23 23:52:47,451 [DEBUG] core.column_mapper: Row 8 (_detect_by_merged_cells): confidence=0.35, headers=['', '', 'GRE.EEC.S.21.IT.P.18371.00.127.00 Technical Specification:\nPPP.PVP PV PARK\nPPP.PVP.FPP FIELD PARALLEL\nPPP.PVP.FPP.01 DC PARALLEL\nPPP.PVP.FPP.03 COMMON EQUIPMENT\nPPP.PVP.CBL CABLES\nPPP.PVP.CBL.02 POWER LV\nPPP.PVP.PVS PV SUPPORT STRUCTURES\nPPP.PVP.PVS.02 STRUCTURES IN ELEVATION\nPPP.PVP.PVS.04 MONO-AXIAL TRACKER\nPPP.PVP.WRK.04 ELECTRICAL FIELD BOX ACTIVITIES\nPPP.PVP.OAT.01 FINISHING\n\nTracker Installation-Maintenance Manual', '', 'Complete Electrical Tracker Installation - Engines, Electronic Systems and batteries (LV aux power and I&C cables excluded) [Q]', 'Mandatory', 'N° Trackers', '195', '6.540228591859193', '40', '261.6091436743677', '', '', '0', '', '', '', '261.6091436743677', '51013.78301650171', ''], reasoning=['Potential merged cells: 9/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,451 [DEBUG] core.column_mapper: Row 9 (_detect_by_keywords): confidence=0.42, headers=['', '', 'GRE….. :\nPPP.PVP PV PARK\nPPP.PVP.FPP FIELD PARALLEL\nPPP.PVP.FPP.01 DC PARALLEL\nPPP.PVP.FPP.03 COMMON EQUIPMENT\nPPP.PVP.CBL CABLES\nPPP.PVP.CBL.02 POWER LV\nPPP.PVP.PVS PV SUPPORT STRUCTURES\nPPP.PVP.PVS.02 STRUCTURES IN ELEVATION\n\nTracker Installation-Maintenance Manual', '', 'MECHANICAL ASSEMBLY OF TRACKERS  STRUCTURES (PV PANELS INSTALLATION EXCLUDED) -1x30 \nIncluding all materials (e.g. coupling nuts and bolts, anchor bolts with specially provided inserts, expansion bolts, welding materials, shims, etc.) and activities necessary to carry out the mechanical installation (e.g. drillings; renovation of hot-dip galvanizing according to the structure manufacturer, if removed/damaged during installation; installation of motor, drive arm mechanism, dampers, spring and any other device necessary for the perfect functioning of the structure; implementation of defense procedures during construction phasis; etc.)', 'Mandatory', 'N° Trackers', '21', '7.0214836444714885', '41', '287.880829423331', '0.8', '70', '56', '', '', '', '343.880829423331', '7221.497417889951', ''], reasoning=["Keyword matches: 'MECHANICAL ASSEMBLY OF TRACKERS  STRUCTURES (PV PANELS INSTALLATION EXCLUDED) -1x30 \nIncluding all materials (e.g. coupling nuts and bolts, anchor bolts with specially provided inserts, expansion bolts, welding materials, shims, etc.) and activities necessary to carry out the mechanical installation (e.g. drillings; renovation of hot-dip galvanizing according to the structure manufacturer, if removed/damaged during installation; installation of motor, drive arm mechanism, dampers, spring and any other device necessary for the perfect functioning of the structure; implementation of defense procedures during construction phasis; etc.)' matches quantity, 'Mandatory' matches classification"]
2025-06-23 23:52:47,451 [DEBUG] core.column_mapper: Row 9 (_detect_by_merged_cells): confidence=0.35, headers=['', '', 'GRE….. :\nPPP.PVP PV PARK\nPPP.PVP.FPP FIELD PARALLEL\nPPP.PVP.FPP.01 DC PARALLEL\nPPP.PVP.FPP.03 COMMON EQUIPMENT\nPPP.PVP.CBL CABLES\nPPP.PVP.CBL.02 POWER LV\nPPP.PVP.PVS PV SUPPORT STRUCTURES\nPPP.PVP.PVS.02 STRUCTURES IN ELEVATION\n\nTracker Installation-Maintenance Manual', '', 'MECHANICAL ASSEMBLY OF TRACKERS  STRUCTURES (PV PANELS INSTALLATION EXCLUDED) -1x30 \nIncluding all materials (e.g. coupling nuts and bolts, anchor bolts with specially provided inserts, expansion bolts, welding materials, shims, etc.) and activities necessary to carry out the mechanical installation (e.g. drillings; renovation of hot-dip galvanizing according to the structure manufacturer, if removed/damaged during installation; installation of motor, drive arm mechanism, dampers, spring and any other device necessary for the perfect functioning of the structure; implementation of defense procedures during construction phasis; etc.)', 'Mandatory', 'N° Trackers', '21', '7.0214836444714885', '41', '287.880829423331', '0.8', '70', '56', '', '', '', '343.880829423331', '7221.497417889951', ''], reasoning=['Potential merged cells: 7/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,452 [INFO] core.column_mapper: Header row found at index 3 with confidence 0.93
2025-06-23 23:52:47,452 [DEBUG] core.column_mapper: Mapping 20 columns to BOQ types (robust)
2025-06-23 23:52:47,454 [DEBUG] core.column_mapper: Demoted column 'WBS (per Mr Quyd)
*da ricostruire struttura' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,454 [DEBUG] core.column_mapper: Demoted column 'Reference Document' from code to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,454 [DEBUG] core.column_mapper: Demoted column 'SCOPE' from description to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,454 [DEBUG] core.column_mapper: Demoted column 'Labour' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,454 [DEBUG] core.column_mapper: Demoted column 'Equipment' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,454 [DEBUG] core.column_mapper: Demoted column 'SUPPLY' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,455 [DEBUG] core.column_mapper: Demoted column 'Notes' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,455 [DEBUG] core.column_mapper: Overall mapping confidence: 0.63
2025-06-23 23:52:47,455 [INFO] core.column_mapper: Mapping completed: 13 columns mapped, confidence: 0.63
2025-06-23 23:52:47,455 [INFO] core.column_mapper: Processing sheet mapping for 12 rows
2025-06-23 23:52:47,455 [DEBUG] core.column_mapper: Searching for header row in 12 rows
2025-06-23 23:52:47,458 [DEBUG] core.column_mapper: Header row candidates:
2025-06-23 23:52:47,458 [DEBUG] core.column_mapper: Row 1 (_detect_by_merged_cells): confidence=0.35, headers=['', 'Spare Parts', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 19/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,459 [DEBUG] core.column_mapper: Row 2 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 1 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,459 [DEBUG] core.column_mapper: Row 3 (_detect_by_keywords): confidence=0.93, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=["Keyword matches: 'WBS (per Mr Quyd)\n*da ricostruire struttura' matches total_price, 'Reference Document' matches code, 'Reference Document' matches code", 'Multiple keyword matches: 20 keywords found']
2025-06-23 23:52:47,459 [DEBUG] core.column_mapper: Row 3 (_detect_by_data_patterns): confidence=0.70, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,459 [DEBUG] core.column_mapper: Row 3 (_detect_by_merged_cells): confidence=0.35, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=['Potential merged cells: 7/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,460 [DEBUG] core.column_mapper: Row 4 (_detect_by_keywords): confidence=0.77, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=["Keyword matches: 'Main equipment used for works, for each item' matches description, 'Main equipment used for works, for each item' matches description, 'Description of supplied materials, for each item' matches description", 'Multiple keyword matches: 4 keywords found']
2025-06-23 23:52:47,460 [DEBUG] core.column_mapper: Row 4 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,460 [DEBUG] core.column_mapper: Row 4 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=['Potential merged cells: 11/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,460 [DEBUG] core.column_mapper: Row 5 (_detect_by_keywords): confidence=0.31, headers=['', 'Spare Parts', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '\xa0', '0', '\xa0'], reasoning=["Keyword matches: 'Total Mandatory' matches total_price, 'Total Mandatory' matches classification"]
2025-06-23 23:52:47,461 [DEBUG] core.column_mapper: Row 5 (_detect_by_data_patterns): confidence=0.70, headers=['', 'Spare Parts', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '\xa0', '0', '\xa0'], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-06-23 23:52:47,461 [DEBUG] core.column_mapper: Row 5 (_detect_by_merged_cells): confidence=0.35, headers=['', 'Spare Parts', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '\xa0', '0', '\xa0'], reasoning=['Potential merged cells: 17/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,461 [DEBUG] core.column_mapper: Row 6 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', 'Total Option', '', '', '', '', '', '', '', '', '', '', '', '\xa0', '91424.48764721675', '\xa0'], reasoning=['Potential merged cells: 18/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,462 [DEBUG] core.column_mapper: Row 8 (_detect_by_keywords): confidence=0.37, headers=['', '', 'GRE.EEC.S.21.IT.P.18371.00.126.01 - SOW BOP Pontestura', '', 'Supply of spare parts for EMBOP as per Technical Specification', 'Optional', 'ls', '1', '', '', '', '', '', '', '', '', '', '91424.48764721675', '91424.48764721675', ''], reasoning=["Keyword matches: 'Supply of spare parts for EMBOP as per Technical Specification' matches description, 'Optional' matches classification"]
2025-06-23 23:52:47,463 [DEBUG] core.column_mapper: Row 8 (_detect_by_merged_cells): confidence=0.35, headers=['', '', 'GRE.EEC.S.21.IT.P.18371.00.126.01 - SOW BOP Pontestura', '', 'Supply of spare parts for EMBOP as per Technical Specification', 'Optional', 'ls', '1', '', '', '', '', '', '', '', '', '', '91424.48764721675', '91424.48764721675', ''], reasoning=['Potential merged cells: 13/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,463 [DEBUG] core.column_mapper: Row 9 (_detect_by_keywords): confidence=0.38, headers=['', '', 'GRE.EEC.S.21.IT.P.18371.00.126.01 - SOW BOP Pontestura', '', 'Supply of spare parts for Cable as per Technical Specification', 'Optional', 'ls', '1', '', '', '0', '', '', '0', '', '', '', '', '0', ''], reasoning=["Keyword matches: 'Supply of spare parts for Cable as per Technical Specification' matches description, 'Optional' matches classification"]
2025-06-23 23:52:47,463 [DEBUG] core.column_mapper: Row 9 (_detect_by_merged_cells): confidence=0.35, headers=['', '', 'GRE.EEC.S.21.IT.P.18371.00.126.01 - SOW BOP Pontestura', '', 'Supply of spare parts for Cable as per Technical Specification', 'Optional', 'ls', '1', '', '', '0', '', '', '0', '', '', '', '', '0', ''], reasoning=['Potential merged cells: 12/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,463 [INFO] core.column_mapper: Header row found at index 3 with confidence 0.93
2025-06-23 23:52:47,463 [DEBUG] core.column_mapper: Mapping 20 columns to BOQ types (robust)
2025-06-23 23:52:47,465 [DEBUG] core.column_mapper: Demoted column 'WBS (per Mr Quyd)
*da ricostruire struttura' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,465 [DEBUG] core.column_mapper: Demoted column 'Reference Document' from code to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,466 [DEBUG] core.column_mapper: Demoted column 'SCOPE' from description to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,466 [DEBUG] core.column_mapper: Demoted column 'Labour' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,466 [DEBUG] core.column_mapper: Demoted column 'Equipment' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,466 [DEBUG] core.column_mapper: Demoted column 'SUPPLY' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,466 [DEBUG] core.column_mapper: Demoted column 'Notes' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,467 [DEBUG] core.column_mapper: Overall mapping confidence: 0.63
2025-06-23 23:52:47,467 [INFO] core.column_mapper: Mapping completed: 13 columns mapped, confidence: 0.63
2025-06-23 23:52:47,467 [INFO] core.column_mapper: Processing sheet mapping for 25 rows
2025-06-23 23:52:47,467 [DEBUG] core.column_mapper: Searching for header row in 25 rows
2025-06-23 23:52:47,471 [DEBUG] core.column_mapper: Header row candidates:
2025-06-23 23:52:47,471 [DEBUG] core.column_mapper: Row 1 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', 'HSE', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 19/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,471 [DEBUG] core.column_mapper: Row 2 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 1 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,471 [DEBUG] core.column_mapper: Row 3 (_detect_by_keywords): confidence=0.93, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=["Keyword matches: 'WBS (per Mr Quyd)\n*da ricostruire struttura' matches total_price, 'Reference Document' matches code, 'Reference Document' matches code", 'Multiple keyword matches: 20 keywords found']
2025-06-23 23:52:47,472 [DEBUG] core.column_mapper: Row 3 (_detect_by_data_patterns): confidence=0.70, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,472 [DEBUG] core.column_mapper: Row 3 (_detect_by_merged_cells): confidence=0.35, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=['Potential merged cells: 7/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,472 [DEBUG] core.column_mapper: Row 4 (_detect_by_keywords): confidence=0.77, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=["Keyword matches: 'Main equipment used for works, for each item' matches description, 'Main equipment used for works, for each item' matches description, 'Description of supplied materials, for each item' matches description", 'Multiple keyword matches: 4 keywords found']
2025-06-23 23:52:47,472 [DEBUG] core.column_mapper: Row 4 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 3 columns']
2025-06-23 23:52:47,472 [DEBUG] core.column_mapper: Row 4 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=['Potential merged cells: 11/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,473 [DEBUG] core.column_mapper: Row 5 (_detect_by_keywords): confidence=0.51, headers=['', 'Safety costs', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '70000', ''], reasoning=["Keyword matches: 'Safety costs' matches total_price, 'Total Mandatory' matches total_price, 'Total Mandatory' matches classification"]
2025-06-23 23:52:47,473 [DEBUG] core.column_mapper: Row 5 (_detect_by_data_patterns): confidence=0.70, headers=['', 'Safety costs', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '70000', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 3 columns']
2025-06-23 23:52:47,473 [DEBUG] core.column_mapper: Row 5 (_detect_by_merged_cells): confidence=0.35, headers=['', 'Safety costs', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '70000', ''], reasoning=['Potential merged cells: 17/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,473 [DEBUG] core.column_mapper: Row 6 (_detect_by_keywords): confidence=0.91, headers=['', '', 'GRE…..', '', 'Items listed in the document PSC/ESS for health, safety and environmental measures tailored for the Project', 'Mandatory', 'ls', '1', '', '', '0', '', '', '0', '', '70000', '', '70000', '70000', 'Items already included in the PSC (Piano Sicurezza e Coordinamento) / ESS (Estudio de Seguridad y Salud)\n\nSafety costs NOT subject to discount'], reasoning=["Keyword matches: 'Items listed in the document PSC/ESS for health, safety and environmental measures tailored for the Project' matches description, 'Items listed in the document PSC/ESS for health, safety and environmental measures tailored for the Project' matches unit, 'Mandatory' matches classification", 'Multiple keyword matches: 7 keywords found']
2025-06-23 23:52:47,473 [DEBUG] core.column_mapper: Row 6 (_detect_by_data_patterns): confidence=0.70, headers=['', '', 'GRE…..', '', 'Items listed in the document PSC/ESS for health, safety and environmental measures tailored for the Project', 'Mandatory', 'ls', '1', '', '', '0', '', '', '0', '', '70000', '', '70000', '70000', 'Items already included in the PSC (Piano Sicurezza e Coordinamento) / ESS (Estudio de Seguridad y Salud)\n\nSafety costs NOT subject to discount'], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,473 [DEBUG] core.column_mapper: Row 6 (_detect_by_merged_cells): confidence=0.35, headers=['', '', 'GRE…..', '', 'Items listed in the document PSC/ESS for health, safety and environmental measures tailored for the Project', 'Mandatory', 'ls', '1', '', '', '0', '', '', '0', '', '70000', '', '70000', '70000', 'Items already included in the PSC (Piano Sicurezza e Coordinamento) / ESS (Estudio de Seguridad y Salud)\n\nSafety costs NOT subject to discount'], reasoning=['Potential merged cells: 9/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,473 [DEBUG] core.column_mapper: Row 7 (_detect_by_keywords): confidence=0.31, headers=['', 'HSE PLAN', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '23544.822930693095', ''], reasoning=["Keyword matches: 'Total Mandatory' matches total_price, 'Total Mandatory' matches classification"]
2025-06-23 23:52:47,473 [DEBUG] core.column_mapper: Row 7 (_detect_by_data_patterns): confidence=0.70, headers=['', 'HSE PLAN', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '23544.822930693095', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,474 [DEBUG] core.column_mapper: Row 7 (_detect_by_merged_cells): confidence=0.35, headers=['', 'HSE PLAN', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '', '23544.822930693095', ''], reasoning=['Potential merged cells: 17/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,474 [DEBUG] core.column_mapper: Row 8 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', 'Total Option', '', '', '', '', '', '', '', '', '', '', '', '', '0', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,474 [DEBUG] core.column_mapper: Row 8 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', 'Total Option', '', '', '', '', '', '', '', '', '', '', '', '', '0', ''], reasoning=['Potential merged cells: 18/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,474 [DEBUG] core.column_mapper: Row 9 (_detect_by_data_patterns): confidence=0.70, headers=['', '', 'HSE Requirements (rev.03):\npar. 17. DOCUMENTATION AND INFORMATION TO BE PROVIDED BY THE CONTRACTOR\npar. 6. HEALTH&SAFETY PLAN\npar. 11.1. 1 Cranes\npar. 16.3.4. Lifting Platform\npar. 16.1. EXCAVATION AND TRENCHING\npar. 7. ENVIRONMENTAL PLAN\npar. 7.1. ENVIRONMENTAL RISK ASSESSMENT\npar. 7.1.1. Storm Water Management Plan (SWMP) and the Erosion Management Plan\npar. 9.3. EMERGENCY PLAN\npar. 6.2.10. Traffic Management\n\n\nCoordination Procedure:\npar. 6 HSE Document Management', '', 'HSE Plans:\n\nHealth & Safety Plan\nRisk Assesment\nLifting Plan\nExcavation Plan\nEnvironmental Plan\nEnvironmentali risk Assessment\nWaste Management Plan\nStorm Water Management Plan\nErosion Management Plan\nEmergency Plan\nTraffic management Plan', 'Mandatory', 'ls', '1', '', '', '0', '', '', '0', '', '23544.822930693095', '', '23544.822930693095', '23544.822930693095', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,474 [DEBUG] core.column_mapper: Row 9 (_detect_by_merged_cells): confidence=0.35, headers=['', '', 'HSE Requirements (rev.03):\npar. 17. DOCUMENTATION AND INFORMATION TO BE PROVIDED BY THE CONTRACTOR\npar. 6. HEALTH&SAFETY PLAN\npar. 11.1. 1 Cranes\npar. 16.3.4. Lifting Platform\npar. 16.1. EXCAVATION AND TRENCHING\npar. 7. ENVIRONMENTAL PLAN\npar. 7.1. ENVIRONMENTAL RISK ASSESSMENT\npar. 7.1.1. Storm Water Management Plan (SWMP) and the Erosion Management Plan\npar. 9.3. EMERGENCY PLAN\npar. 6.2.10. Traffic Management\n\n\nCoordination Procedure:\npar. 6 HSE Document Management', '', 'HSE Plans:\n\nHealth & Safety Plan\nRisk Assesment\nLifting Plan\nExcavation Plan\nEnvironmental Plan\nEnvironmentali risk Assessment\nWaste Management Plan\nStorm Water Management Plan\nErosion Management Plan\nEmergency Plan\nTraffic management Plan', 'Mandatory', 'ls', '1', '', '', '0', '', '', '0', '', '23544.822930693095', '', '23544.822930693095', '23544.822930693095', ''], reasoning=['Potential merged cells: 10/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,474 [INFO] core.column_mapper: Header row found at index 3 with confidence 0.93
2025-06-23 23:52:47,474 [DEBUG] core.column_mapper: Mapping 20 columns to BOQ types (robust)
2025-06-23 23:52:47,476 [DEBUG] core.column_mapper: Demoted column 'WBS (per Mr Quyd)
*da ricostruire struttura' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,477 [DEBUG] core.column_mapper: Demoted column 'Reference Document' from code to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,478 [DEBUG] core.column_mapper: Demoted column 'SCOPE' from description to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,478 [DEBUG] core.column_mapper: Demoted column 'Labour' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,479 [DEBUG] core.column_mapper: Demoted column 'Equipment' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,479 [DEBUG] core.column_mapper: Demoted column 'SUPPLY' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,479 [DEBUG] core.column_mapper: Demoted column 'Notes' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,479 [DEBUG] core.column_mapper: Overall mapping confidence: 0.63
2025-06-23 23:52:47,479 [INFO] core.column_mapper: Mapping completed: 13 columns mapped, confidence: 0.63
2025-06-23 23:52:47,479 [INFO] core.column_mapper: Processing sheet mapping for 13 rows
2025-06-23 23:52:47,479 [DEBUG] core.column_mapper: Searching for header row in 13 rows
2025-06-23 23:52:47,482 [DEBUG] core.column_mapper: Header row candidates:
2025-06-23 23:52:47,482 [DEBUG] core.column_mapper: Row 1 (_detect_by_merged_cells): confidence=0.35, headers=['', 'Sustainability', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 19/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,482 [DEBUG] core.column_mapper: Row 2 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 1 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,483 [DEBUG] core.column_mapper: Row 3 (_detect_by_keywords): confidence=0.93, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=["Keyword matches: 'WBS (per Mr Quyd)\n*da ricostruire struttura' matches total_price, 'Reference Document' matches code, 'Reference Document' matches code", 'Multiple keyword matches: 20 keywords found']
2025-06-23 23:52:47,483 [DEBUG] core.column_mapper: Row 3 (_detect_by_data_patterns): confidence=0.70, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,483 [DEBUG] core.column_mapper: Row 3 (_detect_by_merged_cells): confidence=0.35, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Labour', '', '', 'Equipment', '', '', '', 'SUPPLY', '', 'Unit Price', 'Total Price', 'Notes'], reasoning=['Potential merged cells: 7/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,483 [DEBUG] core.column_mapper: Row 4 (_detect_by_keywords): confidence=0.77, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=["Keyword matches: 'Main equipment used for works, for each item' matches description, 'Main equipment used for works, for each item' matches description, 'Description of supplied materials, for each item' matches description", 'Multiple keyword matches: 4 keywords found']
2025-06-23 23:52:47,484 [DEBUG] core.column_mapper: Row 4 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,484 [DEBUG] core.column_mapper: Row 4 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', '', '', '', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'ORE/U.M.', 'EURO/Hour', 'EURO/U.M.', 'Main equipment used for works, for each item', 'EURO/U.M.', 'Description of supplied materials, for each item', '', '', ''], reasoning=['Potential merged cells: 11/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,484 [DEBUG] core.column_mapper: Row 5 (_detect_by_keywords): confidence=0.31, headers=['', '\xa0Sustainability', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '\xa0', '0', '\xa0'], reasoning=["Keyword matches: 'Total Mandatory' matches total_price, 'Total Mandatory' matches classification"]
2025-06-23 23:52:47,484 [DEBUG] core.column_mapper: Row 5 (_detect_by_data_patterns): confidence=0.70, headers=['', '\xa0Sustainability', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '\xa0', '0', '\xa0'], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-06-23 23:52:47,484 [DEBUG] core.column_mapper: Row 5 (_detect_by_merged_cells): confidence=0.35, headers=['', '\xa0Sustainability', '', '', '', 'Total Mandatory', '', '', '', '', '', '', '', '', '', '', '', '\xa0', '0', '\xa0'], reasoning=['Potential merged cells: 17/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,484 [DEBUG] core.column_mapper: Row 6 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', 'Total Option', '', '', '', '', '', '', '', '', '', '', '', '\xa0', '0', '\xa0'], reasoning=['Potential merged cells: 18/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,484 [DEBUG] core.column_mapper: Row 8 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', 'Sus Plan', 'Mandatory', '', '', '', '', '0', '', '', '0', '', '', '', '0', '0', ''], reasoning=['Potential merged cells: 14/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,484 [DEBUG] core.column_mapper: Row 9 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', 'Mandatory', '', '', '', '', '0', '', '', '0', '', '', '', '0', '0', ''], reasoning=['Potential merged cells: 15/20 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,484 [INFO] core.column_mapper: Header row found at index 3 with confidence 0.93
2025-06-23 23:52:47,485 [DEBUG] core.column_mapper: Mapping 20 columns to BOQ types (robust)
2025-06-23 23:52:47,486 [DEBUG] core.column_mapper: Demoted column 'WBS (per Mr Quyd)
*da ricostruire struttura' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,486 [DEBUG] core.column_mapper: Demoted column 'Reference Document' from code to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,487 [DEBUG] core.column_mapper: Demoted column 'SCOPE' from description to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,487 [DEBUG] core.column_mapper: Demoted column 'Labour' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,487 [DEBUG] core.column_mapper: Demoted column 'Equipment' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,487 [DEBUG] core.column_mapper: Demoted column 'SUPPLY' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,487 [DEBUG] core.column_mapper: Demoted column 'Notes' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,487 [DEBUG] core.column_mapper: Overall mapping confidence: 0.63
2025-06-23 23:52:47,487 [INFO] core.column_mapper: Mapping completed: 13 columns mapped, confidence: 0.63
2025-06-23 23:52:47,487 [INFO] core.column_mapper: Processing sheet mapping for 20 rows
2025-06-23 23:52:47,487 [DEBUG] core.column_mapper: Searching for header row in 20 rows
2025-06-23 23:52:47,489 [DEBUG] core.column_mapper: Header row candidates:
2025-06-23 23:52:47,489 [DEBUG] core.column_mapper: Row 1 (_detect_by_data_patterns): confidence=0.70, headers=['', 'Security', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 1 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,489 [DEBUG] core.column_mapper: Row 1 (_detect_by_merged_cells): confidence=0.35, headers=['', 'Security', '', '', '', '', '', '', '', '', ''], reasoning=['Potential merged cells: 10/11 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,489 [DEBUG] core.column_mapper: Row 2 (_detect_by_data_patterns): confidence=0.70, headers=['', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 3 columns']
2025-06-23 23:52:47,490 [DEBUG] core.column_mapper: Row 3 (_detect_by_keywords): confidence=0.98, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Unit Price', 'Total Price', 'Notes'], reasoning=["Keyword matches: 'WBS (per Mr Quyd)\n*da ricostruire struttura' matches total_price, 'Reference Document' matches code, 'Reference Document' matches code", 'Multiple keyword matches: 20 keywords found']
2025-06-23 23:52:47,490 [DEBUG] core.column_mapper: Row 3 (_detect_by_data_patterns): confidence=1.00, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Unit Price', 'Total Price', 'Notes'], reasoning=['Row contains mostly text', 'Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 2 columns']
2025-06-23 23:52:47,490 [DEBUG] core.column_mapper: Row 3 (_detect_by_merged_cells): confidence=0.35, headers=['', 'WBS (per Mr Quyd)\n*da ricostruire struttura', 'Reference Document', 'Code', 'DESCRIPTION ITEM', 'SCOPE', 'Unit of measure', 'Quantity', 'Unit Price', 'Total Price', 'Notes'], reasoning=['Potential merged cells: 1/11 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,490 [DEBUG] core.column_mapper: Row 4 (_detect_by_keywords): confidence=0.33, headers=['', 'Security', '', '', '', 'Total Mandatory', '', '', '', '52060.21959119917', ''], reasoning=["Keyword matches: 'Total Mandatory' matches total_price, 'Total Mandatory' matches classification"]
2025-06-23 23:52:47,490 [DEBUG] core.column_mapper: Row 4 (_detect_by_data_patterns): confidence=0.70, headers=['', 'Security', '', '', '', 'Total Mandatory', '', '', '', '52060.21959119917', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 1 columns']
2025-06-23 23:52:47,490 [DEBUG] core.column_mapper: Row 4 (_detect_by_merged_cells): confidence=0.35, headers=['', 'Security', '', '', '', 'Total Mandatory', '', '', '', '52060.21959119917', ''], reasoning=['Potential merged cells: 8/11 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,490 [DEBUG] core.column_mapper: Row 5 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', 'Total Option', '', '', '', '0', ''], reasoning=['Potential merged cells: 9/11 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,490 [DEBUG] core.column_mapper: Row 6 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', 'As per Linea guida security rev03 + Elenco elementi security BoQ', 'Mandatory', 'ls', '1', '52060.21959119917', '52060.21959119917', ''], reasoning=['Potential merged cells: 5/11 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,490 [DEBUG] core.column_mapper: Row 7 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', 'Mandatory', 'ls', '', '', '0', ''], reasoning=['Potential merged cells: 8/11 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,491 [DEBUG] core.column_mapper: Row 8 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', 'Optional', 'ls', '', '', '0', ''], reasoning=['Potential merged cells: 8/11 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,491 [DEBUG] core.column_mapper: Row 9 (_detect_by_merged_cells): confidence=0.35, headers=['', '', '', '', '', 'Optional', 'ls', '', '', '0', ''], reasoning=['Potential merged cells: 8/11 empty cells', 'Next row has more detailed headers']
2025-06-23 23:52:47,491 [INFO] core.column_mapper: Header row found at index 3 with confidence 0.98
2025-06-23 23:52:47,491 [DEBUG] core.column_mapper: Mapping 11 columns to BOQ types (robust)
2025-06-23 23:52:47,492 [DEBUG] core.column_mapper: Demoted column 'WBS (per Mr Quyd)
*da ricostruire struttura' from total_price to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,493 [DEBUG] core.column_mapper: Demoted column 'Reference Document' from code to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,493 [DEBUG] core.column_mapper: Demoted column 'SCOPE' from description to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,493 [DEBUG] core.column_mapper: Demoted column 'Notes' from quantity to remarks (uniqueness constraint, no alternatives)
2025-06-23 23:52:47,493 [DEBUG] core.column_mapper: Overall mapping confidence: 0.75
2025-06-23 23:52:47,494 [INFO] core.column_mapper: Mapping completed: 10 columns mapped, confidence: 0.75
2025-06-23 23:52:47,495 [INFO] core.row_classifier: Classifying 107 rows
2025-06-23 23:52:47,524 [INFO] core.row_classifier: Classification completed: {<RowType.PRIMARY_LINE_ITEM: 'primary_line_item'>: 0, <RowType.HEADER_SECTION_BREAK: 'header_section_break'>: 74, <RowType.SUBTOTAL_ROW: 'subtotal_row'>: 22, <RowType.NOTES_COMMENTS: 'notes_comments'>: 2, <RowType.BLANK_SEPARATOR: 'blank_separator'>: 9, <RowType.INVALID_LINE_ITEM: 'invalid_line_item'>: 0}
2025-06-23 23:52:47,524 [INFO] core.row_classifier: Classifying 205 rows
2025-06-23 23:52:47,603 [INFO] core.row_classifier: Classification completed: {<RowType.PRIMARY_LINE_ITEM: 'primary_line_item'>: 0, <RowType.HEADER_SECTION_BREAK: 'header_section_break'>: 164, <RowType.SUBTOTAL_ROW: 'subtotal_row'>: 13, <RowType.NOTES_COMMENTS: 'notes_comments'>: 9, <RowType.BLANK_SEPARATOR: 'blank_separator'>: 18, <RowType.INVALID_LINE_ITEM: 'invalid_line_item'>: 1}
2025-06-23 23:52:47,604 [INFO] core.row_classifier: Classifying 112 rows
2025-06-23 23:52:47,642 [INFO] core.row_classifier: Classification completed: {<RowType.PRIMARY_LINE_ITEM: 'primary_line_item'>: 0, <RowType.HEADER_SECTION_BREAK: 'header_section_break'>: 79, <RowType.SUBTOTAL_ROW: 'subtotal_row'>: 15, <RowType.NOTES_COMMENTS: 'notes_comments'>: 6, <RowType.BLANK_SEPARATOR: 'blank_separator'>: 12, <RowType.INVALID_LINE_ITEM: 'invalid_line_item'>: 0}
2025-06-23 23:52:47,642 [INFO] core.row_classifier: Classifying 263 rows
2025-06-23 23:52:47,737 [INFO] core.row_classifier: Classification completed: {<RowType.PRIMARY_LINE_ITEM: 'primary_line_item'>: 0, <RowType.HEADER_SECTION_BREAK: 'header_section_break'>: 183, <RowType.SUBTOTAL_ROW: 'subtotal_row'>: 58, <RowType.NOTES_COMMENTS: 'notes_comments'>: 4, <RowType.BLANK_SEPARATOR: 'blank_separator'>: 7, <RowType.INVALID_LINE_ITEM: 'invalid_line_item'>: 11}
2025-06-23 23:52:47,738 [INFO] core.row_classifier: Classifying 20 rows
2025-06-23 23:52:47,748 [INFO] core.row_classifier: Classification completed: {<RowType.PRIMARY_LINE_ITEM: 'primary_line_item'>: 0, <RowType.HEADER_SECTION_BREAK: 'header_section_break'>: 14, <RowType.SUBTOTAL_ROW: 'subtotal_row'>: 3, <RowType.NOTES_COMMENTS: 'notes_comments'>: 1, <RowType.BLANK_SEPARATOR: 'blank_separator'>: 2, <RowType.INVALID_LINE_ITEM: 'invalid_line_item'>: 0}
2025-06-23 23:52:47,748 [INFO] core.row_classifier: Classifying 12 rows
2025-06-23 23:52:47,751 [INFO] core.row_classifier: Classification completed: {<RowType.PRIMARY_LINE_ITEM: 'primary_line_item'>: 0, <RowType.HEADER_SECTION_BREAK: 'header_section_break'>: 5, <RowType.SUBTOTAL_ROW: 'subtotal_row'>: 3, <RowType.NOTES_COMMENTS: 'notes_comments'>: 1, <RowType.BLANK_SEPARATOR: 'blank_separator'>: 3, <RowType.INVALID_LINE_ITEM: 'invalid_line_item'>: 0}
2025-06-23 23:52:47,751 [INFO] core.row_classifier: Classifying 25 rows
2025-06-23 23:52:47,755 [INFO] core.row_classifier: Classification completed: {<RowType.PRIMARY_LINE_ITEM: 'primary_line_item'>: 0, <RowType.HEADER_SECTION_BREAK: 'header_section_break'>: 9, <RowType.SUBTOTAL_ROW: 'subtotal_row'>: 12, <RowType.NOTES_COMMENTS: 'notes_comments'>: 1, <RowType.BLANK_SEPARATOR: 'blank_separator'>: 3, <RowType.INVALID_LINE_ITEM: 'invalid_line_item'>: 0}
2025-06-23 23:52:47,755 [INFO] core.row_classifier: Classifying 13 rows
2025-06-23 23:52:47,757 [INFO] core.row_classifier: Classification completed: {<RowType.PRIMARY_LINE_ITEM: 'primary_line_item'>: 0, <RowType.HEADER_SECTION_BREAK: 'header_section_break'>: 6, <RowType.SUBTOTAL_ROW: 'subtotal_row'>: 3, <RowType.NOTES_COMMENTS: 'notes_comments'>: 1, <RowType.BLANK_SEPARATOR: 'blank_separator'>: 3, <RowType.INVALID_LINE_ITEM: 'invalid_line_item'>: 0}
2025-06-23 23:52:47,757 [INFO] core.row_classifier: Classifying 20 rows
2025-06-23 23:52:47,759 [INFO] core.row_classifier: Classification completed: {<RowType.PRIMARY_LINE_ITEM: 'primary_line_item'>: 0, <RowType.HEADER_SECTION_BREAK: 'header_section_break'>: 12, <RowType.SUBTOTAL_ROW: 'subtotal_row'>: 3, <RowType.NOTES_COMMENTS: 'notes_comments'>: 1, <RowType.BLANK_SEPARATOR: 'blank_separator'>: 4, <RowType.INVALID_LINE_ITEM: 'invalid_line_item'>: 0}
2025-06-23 23:52:47,774 [INFO] core.mapping_generator: Generating unified file mapping structure
2025-06-23 23:52:47,777 [INFO] core.mapping_generator: File mapping generated successfully: 9 sheets, global confidence: 0.62
2025-06-23 23:52:47,778 [INFO] root: File processing completed: C:\Users\Admin\Documents\GitHub\BOQ-TOOLS\examples\GRE.EEC.F.27.IT.P.18371.00.098.02 - PONTESTURA 9,69 MW_cBOQ PV_rev 9 giu (ENEMEK).xlsx
