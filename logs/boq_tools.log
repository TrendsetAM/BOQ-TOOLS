2025-11-19 22:10:27,041 [INFO] root: Logging system initialized
2025-11-19 22:10:27,042 [INFO] root: Configuration loaded successfully
2025-11-19 22:10:27,042 [INFO] core.sheet_classifier: Sheet Classifier initialized
2025-11-19 22:10:27,043 [INFO] core.column_mapper: Loaded canonical mappings from C:\Users\Admin\AppData\Roaming\BOQ-TOOLS\canonical_mappings.json
2025-11-19 22:10:27,043 [INFO] core.column_mapper: Column Mapper initialized
2025-11-19 22:10:27,043 [INFO] core.row_classifier: Row Classifier initialized
2025-11-19 22:10:27,044 [INFO] core.validator: Data Validator initialized
2025-11-19 22:10:27,044 [INFO] core.mapping_generator: Mapping Generator initialized
2025-11-19 22:10:27,044 [INFO] utils.export: ExcelExporter initialized.
2025-11-19 22:10:27,044 [INFO] root: Core components initialized successfully
2025-11-19 22:10:27,045 [INFO] root: Settings loaded successfully
2025-11-19 22:10:27,045 [INFO] root: BOQ Tools v1.0.0 initialized successfully
2025-11-19 22:10:30,912 [DEBUG] ui.main_window: Summary grid refresh called
2025-11-19 22:10:33,074 [DEBUG] ui.main_window: Stored file_mapping in tab_id_to_file_mapping for tab: .!frame.!notebook.!frame
2025-11-19 22:10:33,075 [DEBUG] ui.main_window: Stored file_mapping in current_files with key: loaded_analysis_1763586633
2025-11-19 22:10:33,142 [DEBUG] ui.main_window: Looking for offer info for tab path: .!frame.!notebook.!frame
2025-11-19 22:10:33,143 [DEBUG] ui.main_window: No direct file_mapping offer_info, searching through controller files
2025-11-19 22:10:33,143 [DEBUG] ui.main_window: Checking file_key: loaded_analysis_1763586633
2025-11-19 22:10:33,143 [DEBUG] ui.main_window: File data keys: ['file_mapping', 'final_dataframe', 'categorization_result', 'offer_info']
2025-11-19 22:10:33,143 [DEBUG] ui.main_window: Found matching file data for tab path
2025-11-19 22:10:33,143 [DEBUG] ui.main_window: Found offer info in file_mapping: {'offer_name': 'aaa', 'project_name': '', 'project_size': '', 'date': '2025-11-19'}
2025-11-19 22:10:33,144 [INFO] ui.main_window: DEBUG: display_df columns: ['Source_Sheet', 'code', 'Category', 'Description', 'scope', 'unit', 'quantity[aaa]', 'unit_price[aaa]', 'total_price[aaa]', 'manhours[aaa]', 'wage[aaa]', 'quantity[bbb]', 'unit_price[bbb]', 'total_price[bbb]', 'manhours[bbb]', 'wage[bbb]']
2025-11-19 22:10:33,144 [INFO] ui.main_window: DEBUG: comparison_columns found: ['total_price[aaa]', 'total_price[bbb]']
2025-11-19 22:10:33,144 [INFO] ui.main_window: DEBUG: Current offer_name: aaa
2025-11-19 22:10:33,144 [DEBUG] ui.main_window: Processing offer from column total_price[aaa]: offer_name_from_col='aaa', current offer_name='aaa'
2025-11-19 22:10:33,146 [DEBUG] ui.main_window: Added master offer: aaa
2025-11-19 22:10:33,146 [DEBUG] ui.main_window: Processing offer from column total_price[bbb]: offer_name_from_col='bbb', current offer_name='aaa'
2025-11-19 22:10:33,146 [DEBUG] ui.main_window: Added comparison offer: bbb
2025-11-19 22:10:42,252 [DEBUG] ui.main_window: Found file_mapping in tab_id_to_file_mapping for tab: .!frame.!notebook.!frame
2025-11-19 22:10:42,254 [DEBUG] ui.main_window: Found file_mapping in tab_id_to_file_mapping for tab: .!frame.!notebook.!frame
2025-11-19 22:10:42,254 [INFO] ui.main_window: Creating unified DataFrame for master dataset
2025-11-19 22:10:42,255 [INFO] ui.main_window: Using existing dataframe for master: 417 rows, columns: ['Description', 'code', 'unit', 'quantity[aaa]', 'unit_price[aaa]', 'total_price[aaa]', 'Source_Sheet', 'Category', 'manhours[aaa]', 'wage[aaa]', 'scope', 'ignore_28', 'ignore_10', 'ignore', 'ignore_15', 'ignore_2', 'ignore_18', 'ignore_29', 'ignore_1', 'ignore_25', 'ignore_14', 'ignore_20', 'ignore_8', 'ignore_24', 'ignore_13', 'ignore_17', 'ignore_4', 'ignore_12', 'ignore_5', 'ignore_9', 'ignore_16', 'ignore_26', 'ignore_21', 'ignore_11', 'ignore_3', 'ignore_27', 'ignore_7', 'ignore_19', 'ignore_6', 'ignore_23', 'ignore_22', 'quantity[bbb]', 'unit_price[bbb]', 'total_price[bbb]', 'manhours[bbb]', 'wage[bbb]']
2025-11-19 22:10:42,255 [WARNING] ui.main_window: Missing columns in master dataset: ['quantity', 'unit_price', 'total_price']
2025-11-19 22:10:42,258 [INFO] ui.main_window: Sample descriptions in master dataset: ['Cost of Bank Guarantee (Down Payment, Execution, Warranty - exclusion of FX, Tracker, SI, PCU, TC supply)', 'Cleaning of the PV Modules to be carried out immediately before the final electrification and anyway in order to guarantee the optimal performance of the PV Park from the beginning.', 'Topographical survey', 'Geological and geotechnical including surveys and electrical grounding parameters.', 'Underground investigation of existing utilities / foundations']
2025-11-19 22:10:46,091 [DEBUG] ui.main_window: Offer info dialog returned: {'offer_name': 'ccc', 'project_name': '', 'project_size': '', 'date': '2025-11-19', 'timestamp': '2025-11-19 22:10:46'}
2025-11-19 22:10:48,218 [INFO] core.file_processor: Detected file format: xlsx
2025-11-19 22:10:48,559 [INFO] core.file_processor: Successfully loaded Excel file: GRE.EEC.F.27.IT.P.18371.00.098.02 - PONTESTURA 9,69 MW_cBOQ PV_rev 9 giu (ENEMEK).xlsx
2025-11-19 22:10:48,559 [INFO] core.file_processor: Total sheets: 35
2025-11-19 22:10:48,559 [ERROR] ui.main_window: Master file mapping has no sheets info
