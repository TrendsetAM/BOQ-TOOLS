2025-11-13 11:21:20,429 [INFO] root: Logging system initialized
2025-11-13 11:21:20,430 [INFO] root: Configuration loaded successfully
2025-11-13 11:21:20,430 [INFO] core.sheet_classifier: Sheet Classifier initialized
2025-11-13 11:21:20,431 [INFO] core.column_mapper: Loaded canonical mappings from C:\Users\Admin\AppData\Roaming\BOQ-TOOLS\canonical_mappings.json
2025-11-13 11:21:20,431 [INFO] core.column_mapper: Column Mapper initialized
2025-11-13 11:21:20,431 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:20,431 [INFO] core.validator: Data Validator initialized
2025-11-13 11:21:20,431 [INFO] core.mapping_generator: Mapping Generator initialized
2025-11-13 11:21:20,432 [INFO] utils.export: ExcelExporter initialized.
2025-11-13 11:21:20,432 [INFO] root: Core components initialized successfully
2025-11-13 11:21:20,432 [INFO] root: Settings loaded successfully
2025-11-13 11:21:20,433 [INFO] root: BOQ Tools v1.0.0 initialized successfully
2025-11-13 11:21:28,223 [DEBUG] ui.main_window: Summary grid refresh called
2025-11-13 11:21:30,949 [DEBUG] ui.main_window: Offer info dialog returned: {'offer_name': 'aaa', 'project_name': '', 'project_size': '', 'date': '2025-11-13', 'timestamp': '2025-11-13 11:21:30'}
2025-11-13 11:21:35,426 [INFO] core.file_processor: Detected file format: xlsx
2025-11-13 11:21:35,603 [INFO] core.file_processor: Successfully loaded Excel file: Anexo 5.1 GRE.EEC.C.00.CO.P.11002.12.017.01 BoQ PV Valledupar 4_EIFFAGE.xlsx
2025-11-13 11:21:35,604 [INFO] core.file_processor: Total sheets: 14
2025-11-13 11:21:35,604 [INFO] core.file_processor: Found 10 visible sheets out of 14 total
2025-11-13 11:21:50,177 [INFO] root: Processing file: C:\Users\Admin\Desktop\Anexo 5.1 GRE.EEC.C.00.CO.P.11002.12.017.01 BoQ PV Valledupar 4_EIFFAGE.xlsx
2025-11-13 11:21:50,178 [INFO] core.file_processor: Detected file format: xlsx
2025-11-13 11:21:50,410 [INFO] core.file_processor: Successfully loaded Excel file: Anexo 5.1 GRE.EEC.C.00.CO.P.11002.12.017.01 BoQ PV Valledupar 4_EIFFAGE.xlsx
2025-11-13 11:21:50,410 [INFO] core.file_processor: Total sheets: 14
2025-11-13 11:21:50,410 [INFO] core.file_processor: Found 10 visible sheets out of 14 total
2025-11-13 11:21:50,411 [INFO] core.file_processor: Found 10 visible sheets out of 14 total
2025-11-13 11:21:50,531 [DEBUG] core.sheet_classifier: Classifying sheet: General
2025-11-13 11:21:50,540 [DEBUG] core.sheet_classifier: Sheet 'General' classified as line_items with confidence 0.61
2025-11-13 11:21:50,541 [INFO] core.column_mapper: Processing sheet mapping for 59 rows
2025-11-13 11:21:50,541 [DEBUG] core.column_mapper: Searching for header row in 59 rows
2025-11-13 11:21:50,547 [DEBUG] core.column_mapper: Header row candidates:
2025-11-13 11:21:50,547 [DEBUG] core.column_mapper: Row 0 (_detect_by_data_patterns): confidence=0.70, headers=['Project:', 'Valledupar', 'Bill of Quantities and Prices ', 'AC Power (MW):', '0', '', '', '', '', '', '', '', '', '', '', '', 'DC Power (MW):', '118', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 1 rows', 'Currency patterns detected in 2 columns']
2025-11-13 11:21:50,548 [DEBUG] core.column_mapper: Row 1 (_detect_by_data_patterns): confidence=0.70, headers=['Contractor:', 'EIFFAGE ENERGIA COLOMBIA', 'General', 'BASE', 'EIFFAGE ENERGIA COLOMBIA Quantity', 'Labour', '0', '0', 'Equipment', '', '', '', 'SUPPLY', '', 'Price USD', '', 'Price COP', '', 'SOW', 'Type\nS=Supply\nW=Works', 'B=Base Contract\nO=optional', '', ''], reasoning=['Subsequent rows contain numeric data in 1 rows', 'Currency patterns detected in 1 columns']
2025-11-13 11:21:50,548 [DEBUG] core.column_mapper: Row 2 (_detect_by_keywords): confidence=0.96, headers=['Item', 'Reference', 'DESCRIPTION', 'Measurement \nUnit', 'ESTIMATED \nQUANTITY', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'Main equipment used for works, for each item', 'COP/U.M.', 'Description of supplied materials, for each item', 'UNITARY \nPRICE ', 'TOTAL', 'UNITARY \nPRICE ', 'TOTAL', '', '', '', '', ''], reasoning=["Exact keyword matches: 'Item' exactly matches code, 'Reference' exactly matches code, 'DESCRIPTION' exactly matches description", 'Multiple exact keyword matches: 16 keywords found']
2025-11-13 11:21:50,548 [DEBUG] core.column_mapper: Row 2 (_detect_by_data_patterns): confidence=1.00, headers=['Item', 'Reference', 'DESCRIPTION', 'Measurement \nUnit', 'ESTIMATED \nQUANTITY', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'Main equipment used for works, for each item', 'COP/U.M.', 'Description of supplied materials, for each item', 'UNITARY \nPRICE ', 'TOTAL', 'UNITARY \nPRICE ', 'TOTAL', '', '', '', '', ''], reasoning=['Row contains mostly text', 'Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-11-13 11:21:50,548 [DEBUG] core.column_mapper: Row 2 (_detect_by_positional_logic): confidence=0.50, headers=['Item', 'Reference', 'DESCRIPTION', 'Measurement \nUnit', 'ESTIMATED \nQUANTITY', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'Main equipment used for works, for each item', 'COP/U.M.', 'Description of supplied materials, for each item', 'UNITARY \nPRICE ', 'TOTAL', 'UNITARY \nPRICE ', 'TOTAL', '', '', '', '', ''], reasoning=['Left column contains description-like content', 'Middle columns contain quantity/unit content (6 matches)']
2025-11-13 11:21:50,549 [DEBUG] core.column_mapper: Row 3 (_detect_by_data_patterns): confidence=0.70, headers=['G1', '', 'GENERAL', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-11-13 11:21:50,549 [DEBUG] core.column_mapper: Row 4 (_detect_by_data_patterns): confidence=0.70, headers=['G1.1', 'SOW', 'CIAO', 'set', '1', '', '', '120482.256', '', '', '0', '', '', '', '120482.256', '120482.256', '', '', '', 'W', 'B', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-11-13 11:21:50,549 [DEBUG] core.column_mapper: Row 16 (_detect_by_data_patterns): confidence=0.70, headers=['G5', '', 'ENVIRONMENTAL', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-11-13 11:21:50,549 [DEBUG] core.column_mapper: Row 17 (_detect_by_data_patterns): confidence=0.70, headers=['G5.1', 'SOW\n(and Permits)', 'Execution of the environmental works, environmental Mitigation and Restoration Works', 'set', '1', '', '', '500166.89600000007', '', '', '0', '', '', '', '', '', '2000667584.0000002', '2000667584.0000002', '', 'W', 'B', 'Only the felling of trees and the inherent to the construction are considered', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-11-13 11:21:50,549 [DEBUG] core.column_mapper: Row 18 (_detect_by_data_patterns): confidence=0.70, headers=['G6', '', 'SITE CAMP', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 1 columns']
2025-11-13 11:21:50,550 [INFO] core.column_mapper: Header row found at index 2 with confidence 1.00
2025-11-13 11:21:50,550 [INFO] core.column_mapper: Applying consistent enhancement logic to auto-detected header row 2
2025-11-13 11:21:50,550 [INFO] core.column_mapper: Processing sheet mapping with forced header row 2 for 59 rows
2025-11-13 11:21:50,551 [DEBUG] core.column_mapper: Mapping 23 columns to BOQ types (canonical only)
2025-11-13 11:21:50,551 [DEBUG] core.column_mapper: Demoted column 'Reference' from code to ignore (duplicate required column)
2025-11-13 11:21:50,551 [DEBUG] core.column_mapper: Demoted column 'UNITARY 
PRICE' from unit_price to ignore (duplicate required column)
2025-11-13 11:21:50,551 [DEBUG] core.column_mapper: Demoted column 'TOTAL' from total_price to ignore (duplicate required column)
2025-11-13 11:21:50,551 [DEBUG] core.column_mapper: Overall mapping confidence: 0.26
2025-11-13 11:21:50,552 [INFO] core.column_mapper: Forced header mapping completed: 23 columns mapped, confidence: 0.26
2025-11-13 11:21:50,552 [INFO] core.row_classifier: Classifying 59 rows
2025-11-13 11:21:50,564 [INFO] core.row_classifier: Classification completed: {<RowType.PRIMARY_LINE_ITEM: 'primary_line_item'>: 10, <RowType.HEADER_SECTION_BREAK: 'header_section_break'>: 0, <RowType.SUBTOTAL_ROW: 'subtotal_row'>: 0, <RowType.NOTES_COMMENTS: 'notes_comments'>: 0, <RowType.BLANK_SEPARATOR: 'blank_separator'>: 0, <RowType.INVALID_LINE_ITEM: 'invalid_line_item'>: 49}
2025-11-13 11:21:50,567 [INFO] core.mapping_generator: Generating unified file mapping structure
2025-11-13 11:21:50,567 [INFO] core.mapping_generator: File mapping generated successfully: 1 sheets, global confidence: 0.49
2025-11-13 11:21:50,568 [INFO] root: File processing completed: C:\Users\Admin\Desktop\Anexo 5.1 GRE.EEC.C.00.CO.P.11002.12.017.01 BoQ PV Valledupar 4_EIFFAGE.xlsx
2025-11-13 11:21:50,568 [DEBUG] ui.main_window: Applied sheet type 'BOQ' to sheet 'General'
2025-11-13 11:21:50,568 [INFO] ui.main_window: Processing complete for file: C:/Users/Admin/Desktop/Anexo 5.1 GRE.EEC.C.00.CO.P.11002.12.017.01 BoQ PV Valledupar 4_EIFFAGE.xlsx
2025-11-13 11:21:50,569 [DEBUG] ui.main_window: Original offer_info: {'offer_name': 'aaa', 'project_name': '', 'project_size': '', 'date': '2025-11-13', 'timestamp': '2025-11-13 11:21:30'}
2025-11-13 11:21:50,569 [DEBUG] ui.main_window: Enhanced offer_info: {'offer_name': 'aaa', 'project_name': '', 'project_size': '', 'date': '2025-11-13'}
2025-11-13 11:21:50,569 [DEBUG] ui.main_window: Stored offer info for offer_name 'aaa': {'offer_name': 'aaa', 'project_name': '', 'project_size': '', 'date': '2025-11-13'}
2025-11-13 11:21:50,569 [DEBUG] ui.main_window: Stored offer info directly in file_mapping: {'offer_name': 'aaa', 'project_name': '', 'project_size': '', 'date': '2025-11-13'}
2025-11-13 11:21:50,570 [DEBUG] ui.main_window: Stored current_file_mapping reference
2025-11-13 11:21:50,576 [DEBUG] ui.main_window: Calling centralized summary grid refresh
2025-11-13 11:21:50,576 [DEBUG] ui.main_window: Summary grid refresh called
2025-11-13 11:21:52,954 [DEBUG] ui.main_window: Mapping already present: 'Item' -> 'code'
2025-11-13 11:21:52,954 [DEBUG] ui.main_window: Mapping already present: 'DESCRIPTION' -> 'description'
2025-11-13 11:21:52,955 [DEBUG] ui.main_window: Mapping already present: 'Measurement 
Unit' -> 'unit'
2025-11-13 11:21:52,955 [DEBUG] ui.main_window: Mapping already present: 'ESTIMATED 
QUANTITY' -> 'quantity'
2025-11-13 11:21:52,955 [DEBUG] ui.main_window: Mapping already present: 'UNITARY 
PRICE' -> 'unit_price'
2025-11-13 11:21:52,955 [DEBUG] ui.main_window: Mapping already present: 'TOTAL' -> 'total_price'
2025-11-13 11:21:52,956 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,956 [INFO] core.row_classifier: Classifying 58 rows
2025-11-13 11:21:52,964 [INFO] core.row_classifier: Classification completed: {<RowType.PRIMARY_LINE_ITEM: 'primary_line_item'>: 10, <RowType.HEADER_SECTION_BREAK: 'header_section_break'>: 0, <RowType.SUBTOTAL_ROW: 'subtotal_row'>: 0, <RowType.NOTES_COMMENTS: 'notes_comments'>: 0, <RowType.BLANK_SEPARATOR: 'blank_separator'>: 0, <RowType.INVALID_LINE_ITEM: 'invalid_line_item'>: 48}
2025-11-13 11:21:52,969 [INFO] ui.main_window: _show_row_review called
2025-11-13 11:21:52,970 [INFO] ui.main_window: File mapping type: <class 'core.mapping_generator.FileMapping'>
2025-11-13 11:21:52,970 [INFO] ui.main_window: File mapping offer_info: {'offer_name': 'aaa', 'project_name': '', 'project_size': '', 'date': '2025-11-13'}
2025-11-13 11:21:52,970 [INFO] ui.main_window: Is comparison workflow: False
2025-11-13 11:21:52,970 [INFO] ui.main_window: Pending comparison export: False
2025-11-13 11:21:52,977 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,978 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,978 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,978 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,979 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,979 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,979 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,979 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,980 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,980 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,980 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,980 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,981 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,981 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,981 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,981 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,982 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,982 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,982 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,982 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,983 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,983 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,983 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,983 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,984 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,984 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,984 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,984 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,985 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,985 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,985 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,985 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,986 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,986 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,986 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,987 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,987 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,988 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,988 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,988 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,989 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,989 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,990 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,990 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,990 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,990 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,991 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,991 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,991 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,991 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,992 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,992 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,992 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,992 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,992 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,993 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,993 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:52,993 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 11:21:55,122 [INFO] ui.main_window: _on_confirm_row_review called
2025-11-13 11:21:55,123 [INFO] ui.main_window: Current tab ID: .!frame.!notebook.!frame
2025-11-13 11:21:55,124 [INFO] ui.main_window: Current file mapping: FileMapping(metadata=FileMetadata(filename='unknown', file_path='C:\\Users\\Admin\\Desktop\\Anexo 5.1 GRE.EEC.C.00.CO.P.11002.12.017.01 BoQ PV Valledupar 4_EIFFAGE.xlsx', file_size_mb=0.40196895599365234, file_format='xlsx', processing_date=datetime.datetime(2025, 11, 13, 11, 21, 50, 567486), total_sheets=14, visible_sheets=['TITLE BLOCK', 'Guida alla compilazione', 'Index', 'General', 'Civil Works', 'EMBOP-SI', 'EMBOP-TRK Install.', 'Sust Proj Plan', 'Optimization List', 'Summary'], processing_version='1.0.0'), sheets=[SheetMapping(sheet_name='General', processing_status='SUCCESS', row_count=58, column_count=23, header_row_index=2, header_confidence=1.0, column_mappings=[ColumnMappingInfo(column_index=0, original_header='Item', normalized_header='item', mapped_type='code', confidence=1.0, alternatives=[{'type': 'code', 'confidence': 1.0}], reasoning=["Canonical match for 'Item' as 'code'"], is_required=True, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=1, original_header='Reference', normalized_header='reference', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'code', 'confidence': 1.0}], reasoning=["Canonical match for 'Reference' as 'code'", "Demoted from 'code' to 'ignore' - duplicate required column"], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=2, original_header='DESCRIPTION', normalized_header='description', mapped_type='description', confidence=1.0, alternatives=[{'type': 'description', 'confidence': 1.0}], reasoning=["Canonical match for 'DESCRIPTION' as 'description'"], is_required=True, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=3, original_header='Measurement \nUnit', normalized_header='measurementunit', mapped_type='unit', confidence=1.0, alternatives=[{'type': 'unit', 'confidence': 1.0}], reasoning=["Canonical match for 'Measurement \nUnit' as 'unit'"], is_required=True, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=4, original_header='ESTIMATED \nQUANTITY', normalized_header='estimatedquantity', mapped_type='quantity', confidence=1.0, alternatives=[{'type': 'quantity', 'confidence': 1.0}], reasoning=["Canonical match for 'ESTIMATED \nQUANTITY' as 'quantity'"], is_required=True, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=5, original_header='ORE/U.M.', normalized_header='oreum', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=["No canonical match found for 'ORE/U.M.' - requires manual mapping"], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=6, original_header='COP/Hour', normalized_header='cophour', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=["No canonical match found for 'COP/Hour' - requires manual mapping"], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=7, original_header='COP/U.M.', normalized_header='copum', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=["No canonical match found for 'COP/U.M.' - requires manual mapping"], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=8, original_header='ORE/U.M.', normalized_header='oreum', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=["No canonical match found for 'ORE/U.M.' - requires manual mapping"], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=9, original_header='COP/Hour', normalized_header='cophour', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=["No canonical match found for 'COP/Hour' - requires manual mapping"], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=10, original_header='COP/U.M.', normalized_header='copum', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=["No canonical match found for 'COP/U.M.' - requires manual mapping"], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=11, original_header='Main equipment used for works, for each item', normalized_header='mainequipmentusedforworksforeachitem', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=["No canonical match found for 'Main equipment used for works, for each item' - requires manual mapping"], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=12, original_header='COP/U.M.', normalized_header='copum', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=["No canonical match found for 'COP/U.M.' - requires manual mapping"], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=13, original_header='Description of supplied materials, for each item', normalized_header='descriptionofsuppliedmaterialsforeachitem', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=["No canonical match found for 'Description of supplied materials, for each item' - requires manual mapping"], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=14, original_header='UNITARY \nPRICE', normalized_header='unitaryprice', mapped_type='unit_price', confidence=1.0, alternatives=[{'type': 'unit_price', 'confidence': 1.0}], reasoning=["Canonical match for 'UNITARY \nPRICE' as 'unit_price'"], is_required=True, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=15, original_header='TOTAL', normalized_header='total', mapped_type='total_price', confidence=1.0, alternatives=[{'type': 'total_price', 'confidence': 1.0}], reasoning=["Canonical match for 'TOTAL' as 'total_price'"], is_required=True, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=16, original_header='UNITARY \nPRICE', normalized_header='unitaryprice', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'unit_price', 'confidence': 1.0}], reasoning=["Canonical match for 'UNITARY \nPRICE' as 'unit_price'", "Demoted from 'unit_price' to 'ignore' - duplicate required column"], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=17, original_header='TOTAL', normalized_header='total', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'total_price', 'confidence': 1.0}], reasoning=["Canonical match for 'TOTAL' as 'total_price'", "Demoted from 'total_price' to 'ignore' - duplicate required column"], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=18, original_header='', normalized_header='', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=['Empty header - mapped to ignore'], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=19, original_header='', normalized_header='', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=['Empty header - mapped to ignore'], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=20, original_header='', normalized_header='', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=['Empty header - mapped to ignore'], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=21, original_header='', normalized_header='', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=['Empty header - mapped to ignore'], is_required=False, validation_status='valid', is_user_edited=False), ColumnMappingInfo(column_index=22, original_header='', normalized_header='', mapped_type='ignore', confidence=0.0, alternatives=[{'type': 'ignore', 'confidence': 0.0}], reasoning=['Empty header - mapped to ignore'], is_required=False, validation_status='valid', is_user_edited=False)], row_classifications=[RowClassificationInfo(row_index=0, row_type='invalid_line_item', confidence=0.9, completeness_score=0.5333333333333333, hierarchical_level=None, section_title='Project:', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_1', row_data=None), RowClassificationInfo(row_index=1, row_type='invalid_line_item', confidence=0.9, completeness_score=0.7666666666666666, hierarchical_level=None, section_title='Contractor:', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_2', row_data=None), RowClassificationInfo(row_index=3, row_type='invalid_line_item', confidence=0.9, completeness_score=0.3333333333333333, hierarchical_level=None, section_title='GENERAL', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_3', row_data=None), RowClassificationInfo(row_index=4, row_type='primary_line_item', confidence=0.95, completeness_score=1.0, hierarchical_level=None, section_title='G1.1', validation_errors=[], reasoning=['Row has description, unit price, and total price - VALID line item'], position='General_4', row_data=None), RowClassificationInfo(row_index=5, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G1.2', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_5', row_data=None), RowClassificationInfo(row_index=6, row_type='invalid_line_item', confidence=0.9, completeness_score=0.3333333333333333, hierarchical_level=None, section_title='ENGINEERING', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_6', row_data=None), RowClassificationInfo(row_index=7, row_type='primary_line_item', confidence=0.95, completeness_score=1.0, hierarchical_level=None, section_title='G2.1', validation_errors=[], reasoning=['Row has description, unit price, and total price - VALID line item'], position='General_7', row_data=None), RowClassificationInfo(row_index=8, row_type='primary_line_item', confidence=0.95, completeness_score=1.0, hierarchical_level=None, section_title='G2.2', validation_errors=[], reasoning=['Row has description, unit price, and total price - VALID line item'], position='General_8', row_data=None), RowClassificationInfo(row_index=9, row_type='invalid_line_item', confidence=0.9, completeness_score=0.3333333333333333, hierarchical_level=None, section_title='PROJECT AND SITE MANAGEMENT', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_9', row_data=None), RowClassificationInfo(row_index=10, row_type='primary_line_item', confidence=0.95, completeness_score=1.0, hierarchical_level=None, section_title='G4.1', validation_errors=[], reasoning=['Row has description, unit price, and total price - VALID line item'], position='General_10', row_data=None), RowClassificationInfo(row_index=11, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G4.2', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_11', row_data=None), RowClassificationInfo(row_index=12, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G4.3', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_12', row_data=None), RowClassificationInfo(row_index=13, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G4.4', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_13', row_data=None), RowClassificationInfo(row_index=14, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G4.5', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_14', row_data=None), RowClassificationInfo(row_index=15, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G4.6', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_15', row_data=None), RowClassificationInfo(row_index=16, row_type='invalid_line_item', confidence=0.9, completeness_score=0.3333333333333333, hierarchical_level=None, section_title='ENVIRONMENTAL', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_16', row_data=None), RowClassificationInfo(row_index=17, row_type='invalid_line_item', confidence=0.9, completeness_score=0.5333333333333333, hierarchical_level=None, section_title='G5.1', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_17', row_data=None), RowClassificationInfo(row_index=18, row_type='invalid_line_item', confidence=0.9, completeness_score=0.3333333333333333, hierarchical_level=None, section_title='SITE CAMP', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_18', row_data=None), RowClassificationInfo(row_index=19, row_type='primary_line_item', confidence=0.95, completeness_score=1.0, hierarchical_level=None, section_title='G6.1', validation_errors=[], reasoning=['Row has description, unit price, and total price - VALID line item'], position='General_19', row_data=None), RowClassificationInfo(row_index=20, row_type='primary_line_item', confidence=0.95, completeness_score=0.8999999999999999, hierarchical_level=None, section_title='G6.2', validation_errors=[], reasoning=['Row has description, unit price, and total price - VALID line item'], position='General_20', row_data=None), RowClassificationInfo(row_index=21, row_type='primary_line_item', confidence=0.95, completeness_score=0.8999999999999999, hierarchical_level=None, section_title='G6.3', validation_errors=[], reasoning=['Row has description, unit price, and total price - VALID line item'], position='General_21', row_data=None), RowClassificationInfo(row_index=22, row_type='primary_line_item', confidence=0.95, completeness_score=1.0, hierarchical_level=None, section_title='G6.4', validation_errors=[], reasoning=['Row has description, unit price, and total price - VALID line item'], position='General_22', row_data=None), RowClassificationInfo(row_index=23, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G6.5', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_23', row_data=None), RowClassificationInfo(row_index=24, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G6.6', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_24', row_data=None), RowClassificationInfo(row_index=25, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G6.7', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_25', row_data=None), RowClassificationInfo(row_index=26, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G6.8', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_26', row_data=None), RowClassificationInfo(row_index=27, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G6.9', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_27', row_data=None), RowClassificationInfo(row_index=28, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G6.10', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_28', row_data=None), RowClassificationInfo(row_index=29, row_type='invalid_line_item', confidence=0.9, completeness_score=0.3333333333333333, hierarchical_level=None, section_title='UNLOADING AND STORAGE OF SI / PCU/ TC', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_29', row_data=None), RowClassificationInfo(row_index=30, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G7.1', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_30', row_data=None), RowClassificationInfo(row_index=31, row_type='invalid_line_item', confidence=0.9, completeness_score=0.3333333333333333, hierarchical_level=None, section_title='UNLOADING AND STORAGE OF TRACKER', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_31', row_data=None), RowClassificationInfo(row_index=32, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G8.1', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_32', row_data=None), RowClassificationInfo(row_index=33, row_type='invalid_line_item', confidence=0.9, completeness_score=0.3333333333333333, hierarchical_level=None, section_title='UNLOADING AND STORAGE OF FIXED STRUTURES', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_33', row_data=None), RowClassificationInfo(row_index=34, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G9.1', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_34', row_data=None), RowClassificationInfo(row_index=35, row_type='invalid_line_item', confidence=0.9, completeness_score=0.3333333333333333, hierarchical_level=None, section_title='PV MODULE CLEANING', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_35', row_data=None), RowClassificationInfo(row_index=36, row_type='primary_line_item', confidence=0.95, completeness_score=1.0, hierarchical_level=None, section_title='G10.1', validation_errors=[], reasoning=['Row has description, unit price, and total price - VALID line item'], position='General_36', row_data=None), RowClassificationInfo(row_index=37, row_type='invalid_line_item', confidence=0.9, completeness_score=0.3333333333333333, hierarchical_level=None, section_title='BACK UP PARTS', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_37', row_data=None), RowClassificationInfo(row_index=38, row_type='invalid_line_item', confidence=0.9, completeness_score=0.4333333333333333, hierarchical_level=None, section_title='G11.1', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_38', row_data=None), RowClassificationInfo(row_index=39, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_39', row_data=None), RowClassificationInfo(row_index=40, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_40', row_data=None), RowClassificationInfo(row_index=41, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_41', row_data=None), RowClassificationInfo(row_index=42, row_type='invalid_line_item', confidence=0.9, completeness_score=0.3333333333333333, hierarchical_level=None, section_title='General', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_42', row_data=None), RowClassificationInfo(row_index=43, row_type='invalid_line_item', confidence=0.9, completeness_score=1.0, hierarchical_level=None, section_title='Item', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_43', row_data=None), RowClassificationInfo(row_index=44, row_type='invalid_line_item', confidence=0.9, completeness_score=0.3333333333333333, hierarchical_level=None, section_title='SITE CAMP', validation_errors=[], reasoning=['Missing required fields: unit price, total price - INVALID line item'], position='General_44', row_data=None), RowClassificationInfo(row_index=45, row_type='primary_line_item', confidence=0.95, completeness_score=1.0, hierarchical_level=None, section_title='OG6.1', validation_errors=[], reasoning=['Row has description, unit price, and total price - VALID line item'], position='General_45', row_data=None), RowClassificationInfo(row_index=46, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_46', row_data=None), RowClassificationInfo(row_index=47, row_type='invalid_line_item', confidence=0.9, completeness_score=0.2333333333333333, hierarchical_level=None, section_title='Total Works', validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_47', row_data=None), RowClassificationInfo(row_index=48, row_type='invalid_line_item', confidence=0.9, completeness_score=0.2333333333333333, hierarchical_level=None, section_title='Base General', validation_errors=[], reasoning=['Missing required fields: description, unit price - INVALID line item'], position='General_48', row_data=None), RowClassificationInfo(row_index=49, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title='Options General', validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_49', row_data=None), RowClassificationInfo(row_index=50, row_type='invalid_line_item', confidence=0.9, completeness_score=0.2333333333333333, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price - INVALID line item'], position='General_50', row_data=None), RowClassificationInfo(row_index=51, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_51', row_data=None), RowClassificationInfo(row_index=52, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_52', row_data=None), RowClassificationInfo(row_index=53, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_53', row_data=None), RowClassificationInfo(row_index=54, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_54', row_data=None), RowClassificationInfo(row_index=55, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_55', row_data=None), RowClassificationInfo(row_index=56, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_56', row_data=None), RowClassificationInfo(row_index=57, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_57', row_data=None), RowClassificationInfo(row_index=58, row_type='invalid_line_item', confidence=0.9, completeness_score=0.0, hierarchical_level=None, section_title=None, validation_errors=[], reasoning=['Missing required fields: description, unit price, total price - INVALID line item'], position='General_58', row_data=None)], validation_summary=ValidationSummary(overall_score=0.38, mathematical_consistency=0.0, data_type_quality=0.0, business_rule_compliance=0.0, error_count=0, warning_count=0, info_count=0, suggestions=['Fix 5 critical validation errors', 'Review 6 validation warnings', 'Standardize data formats across columns']), overall_confidence=0.9147058823529403, column_mapping_confidence=0.25764192139737996, row_classification_confidence=0.9144927536231875, data_quality_confidence=0.38, review_flags=[<ReviewFlag.LOW_CONFIDENCE: 'low_confidence'>, <ReviewFlag.MISSING_DATA: 'missing_data'>, <ReviewFlag.MANUAL_REVIEW_REQUIRED: 'manual_review_required'>], manual_review_items=[{'type': 'low_confidence_column', 'column_index': 1, 'header': 'Reference', 'confidence': 0.0, 'alternatives': [{'type': 'code', 'confidence': 1.0}]}, {'type': 'low_confidence_column', 'column_index': 5, 'header': 'ORE/U.M.', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 6, 'header': 'COP/Hour', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 7, 'header': 'COP/U.M.', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 8, 'header': 'ORE/U.M.', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 9, 'header': 'COP/Hour', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 10, 'header': 'COP/U.M.', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 11, 'header': 'Main equipment used for works, for each item', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 12, 'header': 'COP/U.M.', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 13, 'header': 'Description of supplied materials, for each item', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 16, 'header': 'UNITARY \nPRICE', 'confidence': 0.0, 'alternatives': [{'type': 'unit_price', 'confidence': 1.0}]}, {'type': 'low_confidence_column', 'column_index': 17, 'header': 'TOTAL', 'confidence': 0.0, 'alternatives': [{'type': 'total_price', 'confidence': 1.0}]}, {'type': 'low_confidence_column', 'column_index': 18, 'header': '', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 19, 'header': '', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 20, 'header': '', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 21, 'header': '', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'low_confidence_column', 'column_index': 22, 'header': '', 'confidence': 0.0, 'alternatives': [{'type': 'ignore', 'confidence': 0.0}]}, {'type': 'missing_data_row', 'row_index': 39, 'completeness_score': 0.0}, {'type': 'missing_data_row', 'row_index': 40, 'completeness_score': 0.0}, {'type': 'missing_data_row', 'row_index': 41, 'completeness_score': 0.0}, {'type': 'missing_data_row', 'row_index': 46, 'completeness_score': 0.0}, {'type': 'missing_data_row', 'row_index': 47, 'completeness_score': 0.2333333333333333}, {'type': 'missing_data_row', 'row_index': 48, 'completeness_score': 0.2333333333333333}, {'type': 'missing_data_row', 'row_index': 49, 'completeness_score': 0.0}, {'type': 'missing_data_row', 'row_index': 50, 'completeness_score': 0.2333333333333333}, {'type': 'missing_data_row', 'row_index': 51, 'completeness_score': 0.0}, {'type': 'missing_data_row', 'row_index': 52, 'completeness_score': 0.0}, {'type': 'missing_data_row', 'row_index': 53, 'completeness_score': 0.0}, {'type': 'missing_data_row', 'row_index': 54, 'completeness_score': 0.0}, {'type': 'missing_data_row', 'row_index': 55, 'completeness_score': 0.0}, {'type': 'missing_data_row', 'row_index': 56, 'completeness_score': 0.0}, {'type': 'missing_data_row', 'row_index': 57, 'completeness_score': 0.0}, {'type': 'missing_data_row', 'row_index': 58, 'completeness_score': 0.0}], processing_notes=['17 columns have low confidence mappings', 'High number of invalid line items (49/59) - check data quality', 'Fix 5 critical validation errors', 'Review 6 validation warnings', 'Standardize data formats across columns'], warnings=[], processing_time=0.0, sheet_type='BOQ', sheet_data=[['Project:', 'Valledupar', 'Bill of Quantities and Prices ', 'AC Power (MW):', '0', '', '', '', '', '', '', '', '', '', '', '', 'DC Power (MW):', '118', '', '', '', '', ''], ['Contractor:', 'EIFFAGE ENERGIA COLOMBIA', 'General', 'BASE', 'EIFFAGE ENERGIA COLOMBIA Quantity', 'Labour', '0', '0', 'Equipment', '', '', '', 'SUPPLY', '', 'Price USD', '', 'Price COP', '', 'SOW', 'Type\nS=Supply\nW=Works', 'B=Base Contract\nO=optional', '', ''], ['Item', 'Reference', 'DESCRIPTION', 'Measurement \nUnit', 'ESTIMATED \nQUANTITY', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'Main equipment used for works, for each item', 'COP/U.M.', 'Description of supplied materials, for each item', 'UNITARY \nPRICE ', 'TOTAL', 'UNITARY \nPRICE ', 'TOTAL', '', '', '', '', ''], ['G1', '', 'GENERAL', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['G1.1', 'SOW', 'CIAO', 'set', '1', '', '', '120482.256', '', '', '0', '', '', '', '120482.256', '120482.256', '', '', '', 'W', 'B', '', ''], ['G1.2', 'SOW', 'Standard Safety Costs', 'set', '', '', '', '', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', 'Included Item G1.1', ''], ['G2', '', 'ENGINEERING', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['G2.1', 'SOW', 'Detail Design (Civil Design, Electrical Design, Cable Design etc as per DPP) & As-Built Design', 'set', '1', '', '', '261446.4846', '', '', '0', '', '', '', '261446.4846', '261446.4846', '', '', '', 'W', 'B', 'inclusi studi idraulici, geologia e topografia', ''], ['G2.2', 'Grid Code', 'Documentation and Studies accordinly Grid Operator Needs (e.i. Dynamic Model of the whole system LV/MV/HV, etc)', 'set', '1', '', '', '112048.49339999999', '', '', '0', '', '', '', '112048.49339999999', '112048.49339999999', '', '', '', 'W', 'B', '', ''], ['G4', '', 'PROJECT AND SITE MANAGEMENT', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['G4.1', 'SOW', 'Project Manager', 'n.pers x days', '1', '', '', '2906211.094', '', '', '0', '', '', '', '2906211.094', '2906211.094', '', '', '', 'W', 'B', '', ''], ['G4.2', 'SOW', 'Construction Manager', 'n.pers x days', '', '', '', '0', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G4.3', 'SOW', 'Supervisor - Civil & Electrical', 'n.pers x days', '', '', '', '0', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G4.4', 'SOW', 'HSE Manager', 'n.pers x days', '', '', '', '0', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G4.5', 'SOW', 'Contract Manager / Procurement Manager', 'n.pers x days', '', '', '', '0', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G4.6', 'SOW', 'Other Personnel (Quality, Logistic Coord, Env. Coord, Project Control, ... )', 'n.pers x days', '', '', '', '0', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G5', '', 'ENVIRONMENTAL', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['G5.1', 'SOW\n(and Permits)', 'Execution of the environmental works, environmental Mitigation and Restoration Works', 'set', '1', '', '', '500166.89600000007', '', '', '0', '', '', '', '', '', '2000667584.0000002', '2000667584.0000002', '', 'W', 'B', 'Only the felling of trees and the inherent to the construction are considered', ''], ['G6', '', 'SITE CAMP', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['G6.1', 'SOW', 'Facilities (Canteen, Changing Room and Toilets)', 'set', '1', '', '', '1194304.402', '', '', '0', '', '', '', '1194304.402', '1194304.402', '', '', '', 'W', 'B', 'All Management Cost acording Eiffage Gantt Proposal.', ''], ['G6.2', 'SOW', 'Offices for EGP site team and Contractors', 'set', '', '', '', '', '', '', '0', '', '', '', '0', '0', '', '', '', 'W', 'B', '', ''], ['G6.3', 'SOW', 'First Aid, Emergency Health Care Facility and Site Signs', 'set', '', '', '', '', '', '', '0', '', '', '', '0', '0', '', '', '', 'W', 'B', '', ''], ['G6.4', 'SOW', 'Main Storage Area for construction, Waste Storage Area, Parking Area, Camp Fences', 'set', '1', '', '', '331846.766', '', '', '0', '', '', '', '331846.766', '331846.766', '', '', '', 'W', 'B', '', ''], ['G6.5', 'SOW', 'Supply & Distribution of Water, Power and Broadband connectivity', 'set', '', '', '', '', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G6.6', 'SOW', 'Site Camp Operation and Maintenance ', 'set', '', '', '', '', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G6.7', 'SOW', 'Other Site Expenses (Contractor to Specify)', 'set', '', '', '', '', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G6.8', 'SOW', 'Accomodation on site (if defined in SoW)', 'set', '', '', '', '', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G6.9', 'SOW', 'Accomodation out of site', 'set', '', '', '', '', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G6.10', 'SOW', 'Transportation for local workers', 'set', '', '', '', '', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G7', '', 'UNLOADING AND STORAGE OF SI / PCU/ TC', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['G7.1', 'SOW', 'Unloading and Storage of SI / PCU/TC', 'set', '', '', '', '', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G8', '', 'UNLOADING AND STORAGE OF TRACKER', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['G8.1', 'SOW', 'Unloading and Storage of the tracker structures and equipments', 'set', '', '', '', '', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G9', '', 'UNLOADING AND STORAGE OF FIXED STRUTURES', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['G9.1', 'SOW', 'Unloading and Storage of all the Equipment on Site', 'set', '', '', '', '', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['G10', '', 'PV MODULE CLEANING', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['G10.1', 'SOW', 'Cleaning of the PV Modules to be carried out immediately before the final electrification and anyway in order to guarantee the optimal performance of the PV Park from the beginning.', 'N PV Modules', '1', '', '0', '81164.16', '', '', '0', '', '', '', '81164.16', '81164.16', '', '', '', 'W', 'B', '', ''], ['G11', '', 'BACK UP PARTS', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['G11.1', 'SOW', 'Supply of back up parts as per Technical Specification', 'set', '', '', '', '', '', '', '0', '', '', '', '', '', '0', '0', '', 'W', 'B', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', 'General', 'OPTIONAL ITEMS', '', '', '', '', '', '', '', '', '', '', '', '', '', '', 'SOW', 'Type\nS=Supply\nW=Works', 'B=Base Contract\nO=optional', '', ''], ['Item', 'Reference', 'DESCRIPTION', 'Measurement \nUnit', 'ESTIMATED \nQUANTITY', '', '', '', '', '', '', '', '', '', 'UNITARY \nPRICE ', 'TOTAL', 'UNITARY \nPRICE ', 'TOTAL', '', '', '', '', ''], ['OG6', '', 'SITE CAMP', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['OG6.1', 'Annex I.6', "Control of the Site's Acceses", 'set', '1', '', '', '890533.789', '', '', '0', '', '', '', '890533.789', '890533.789', '', '', '', 'W', 'B', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', 'Total Works', '', 'Total USD', 'Total Supply', 'Total COP', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', 'Base General', '', '', '', '5898037.445', '0', '2000667584.0000002', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', 'Options General', '', '0', '', '', '0', '0', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '0', '', '5898037.445', '0', '2000667584.0000002', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], ['', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '']])], global_confidence=0.4947529650022148, processing_summary=ProcessingSummary(total_rows_processed=59, total_columns_mapped=23, successful_sheets=0, partial_sheets=0, failed_sheets=0, sheets_needing_review=1, average_confidence=0.49140459464590824, average_data_quality=0.38, total_validation_errors=0, total_validation_warnings=0, processing_time_total=0.0, processing_notes=['17 columns have low confidence mappings', 'High number of invalid line items (49/59) - check data quality', 'Fix 5 critical validation errors', 'Review 6 validation warnings', 'Standardize data formats across columns'], recommendations=['Review 1 sheets with low confidence', 'Review data completeness in 1 sheets']), review_flags=[<ReviewFlag.LOW_CONFIDENCE: 'low_confidence'>, <ReviewFlag.MISSING_DATA: 'missing_data'>, <ReviewFlag.MANUAL_REVIEW_REQUIRED: 'manual_review_required'>], export_ready=False, column_mapper=<core.column_mapper.ColumnMapper object at 0x000002AEF2DA1E80>)
2025-11-13 11:21:55,124 [INFO] ui.main_window: Pending comparison export: False
2025-11-13 11:21:55,125 [INFO] ui.main_window: Is comparison workflow: False
2025-11-13 11:21:55,127 [INFO] ui.main_window: Filtered dataset created with 8 valid rows from 1 sheets
2025-11-13 11:21:55,148 [INFO] __main__: Sheet 'General' column mappings: ['code', 'ignore', 'description', 'unit', 'quantity', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'unit_price', 'total_price', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore']
2025-11-13 11:21:55,148 [INFO] __main__: Sheet 'General' ignore columns: ['ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore', 'ignore']
2025-11-13 11:21:55,149 [INFO] __main__: DataFrame columns before normalization: ['Source_Sheet', 'code', 'description', 'unit', 'quantity', 'unit_price', 'total_price']
2025-11-13 11:21:55,150 [INFO] __main__: DataFrame columns after normalization: ['Source_Sheet', 'code', 'Description', 'unit', 'quantity', 'unit_price', 'total_price']
2025-11-13 11:21:55,152 [INFO] __main__: Final DataFrame columns in order: ['Source_Sheet', 'code', 'Category', 'Description', 'unit', 'quantity', 'unit_price', 'total_price', 'manhours', 'wage']
2025-11-13 11:21:55,159 [INFO] core.category_dictionary: Loaded 948 mappings from C:\Users\Admin\AppData\Roaming\BOQ-TOOLS\category_dictionary.json
2025-11-13 11:21:55,159 [INFO] core.category_dictionary: Category Dictionary initialized with 948 mappings
2025-11-13 11:21:55,163 [INFO] core.auto_categorizer: Starting automatic categorization of 8 rows
2025-11-13 11:21:55,163 [INFO] core.auto_categorizer: Using description column: 'Description'
2025-11-13 11:21:55,167 [INFO] core.auto_categorizer: Categorization completed:
2025-11-13 11:21:55,167 [INFO] core.auto_categorizer:   Total rows: 8
2025-11-13 11:21:55,168 [INFO] core.auto_categorizer:   Matched rows: 7 (87.5%)
2025-11-13 11:21:55,168 [INFO] core.auto_categorizer:   Unmatched rows: 1
2025-11-13 11:21:55,168 [INFO] core.auto_categorizer:   Match types: {'exact': 7, 'none': 1}
2025-11-13 11:21:55,168 [INFO] core.auto_categorizer:   Unique categories assigned: 4
2025-11-13 11:21:55,174 [INFO] core.auto_categorizer: Collecting descriptions for manual review from 8 rows
2025-11-13 11:21:55,175 [DEBUG] core.auto_categorizer: New description for manual review: 'CIAO...' (type: none)
2025-11-13 11:21:55,176 [INFO] core.auto_categorizer: Collected 1 unique descriptions for manual review
2025-11-13 11:21:55,176 [INFO] core.auto_categorizer: Total frequency: 1
2025-11-13 11:21:55,176 [INFO] core.auto_categorizer: Match type breakdown for manual review:
2025-11-13 11:21:55,176 [INFO] core.auto_categorizer:   none: 1
2025-11-13 11:21:55,178 [INFO] core.manual_categorizer: Generating manual categorization Excel file for 1 descriptions
2025-11-13 11:21:55,210 [INFO] core.manual_categorizer: Manual categorization Excel file created: examples\manual_categorization_20251113_112155.xlsx
2025-11-13 11:22:34,854 [DEBUG] ui.main_window: Summary grid refresh called
