2025-11-13 12:25:39,069 [INFO] root: Logging system initialized
2025-11-13 12:25:39,069 [INFO] root: Configuration loaded successfully
2025-11-13 12:25:39,069 [INFO] core.sheet_classifier: Sheet Classifier initialized
2025-11-13 12:25:39,070 [INFO] core.column_mapper: Loaded canonical mappings from C:\Users\Admin\AppData\Roaming\BOQ-TOOLS\canonical_mappings.json
2025-11-13 12:25:39,070 [INFO] core.column_mapper: Column Mapper initialized
2025-11-13 12:25:39,070 [INFO] core.row_classifier: Row Classifier initialized
2025-11-13 12:25:39,071 [INFO] core.validator: Data Validator initialized
2025-11-13 12:25:39,071 [INFO] core.mapping_generator: Mapping Generator initialized
2025-11-13 12:25:39,071 [INFO] utils.export: ExcelExporter initialized.
2025-11-13 12:25:39,071 [INFO] root: Core components initialized successfully
2025-11-13 12:25:39,071 [INFO] root: Settings loaded successfully
2025-11-13 12:25:39,072 [INFO] root: BOQ Tools v1.0.0 initialized successfully
2025-11-13 12:25:44,144 [DEBUG] ui.main_window: Summary grid refresh called
2025-11-13 12:25:47,495 [DEBUG] ui.main_window: Offer info dialog returned: {'offer_name': 'aaa', 'project_name': '', 'project_size': '', 'date': '2025-11-13', 'timestamp': '2025-11-13 12:25:47'}
2025-11-13 12:25:52,153 [INFO] core.file_processor: Detected file format: xlsx
2025-11-13 12:25:52,342 [INFO] core.file_processor: Successfully loaded Excel file: Anexo 5.1 GRE.EEC.C.00.CO.P.11002.12.017.01 BoQ PV Valledupar 4_EIFFAGE.xlsx
2025-11-13 12:25:52,342 [INFO] core.file_processor: Total sheets: 14
2025-11-13 12:25:52,342 [INFO] core.file_processor: Found 10 visible sheets out of 14 total
2025-11-13 12:26:00,541 [INFO] root: Processing file: C:\Users\Admin\Desktop\Anexo 5.1 GRE.EEC.C.00.CO.P.11002.12.017.01 BoQ PV Valledupar 4_EIFFAGE.xlsx
2025-11-13 12:26:00,542 [INFO] core.file_processor: Detected file format: xlsx
2025-11-13 12:26:00,731 [INFO] core.file_processor: Successfully loaded Excel file: Anexo 5.1 GRE.EEC.C.00.CO.P.11002.12.017.01 BoQ PV Valledupar 4_EIFFAGE.xlsx
2025-11-13 12:26:00,731 [INFO] core.file_processor: Total sheets: 14
2025-11-13 12:26:00,732 [INFO] core.file_processor: Found 10 visible sheets out of 14 total
2025-11-13 12:26:00,732 [INFO] core.file_processor: Found 10 visible sheets out of 14 total
2025-11-13 12:26:00,882 [DEBUG] core.sheet_classifier: Classifying sheet: General
2025-11-13 12:26:00,892 [DEBUG] core.sheet_classifier: Sheet 'General' classified as line_items with confidence 0.61
2025-11-13 12:26:00,892 [INFO] core.column_mapper: Processing sheet mapping for 59 rows
2025-11-13 12:26:00,893 [DEBUG] core.column_mapper: Searching for header row in 59 rows
2025-11-13 12:26:00,898 [DEBUG] core.column_mapper: Header row candidates:
2025-11-13 12:26:00,898 [DEBUG] core.column_mapper: Row 0 (_detect_by_data_patterns): confidence=0.70, headers=['Project:', 'Valledupar', 'Bill of Quantities and Prices ', 'AC Power (MW):', '0', '', '', '', '', '', '', '', '', '', '', '', 'DC Power (MW):', '118', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 1 rows', 'Currency patterns detected in 2 columns']
2025-11-13 12:26:00,899 [DEBUG] core.column_mapper: Row 1 (_detect_by_data_patterns): confidence=0.70, headers=['Contractor:', 'EIFFAGE ENERGIA COLOMBIA', 'General', 'BASE', 'EIFFAGE ENERGIA COLOMBIA Quantity', 'Labour', '0', '0', 'Equipment', '', '', '', 'SUPPLY', '', 'Price USD', '', 'Price COP', '', 'SOW', 'Type\nS=Supply\nW=Works', 'B=Base Contract\nO=optional', '', ''], reasoning=['Subsequent rows contain numeric data in 1 rows', 'Currency patterns detected in 1 columns']
2025-11-13 12:26:00,899 [DEBUG] core.column_mapper: Row 2 (_detect_by_keywords): confidence=0.96, headers=['Item', 'Reference', 'DESCRIPTION', 'Measurement \nUnit', 'ESTIMATED \nQUANTITY', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'Main equipment used for works, for each item', 'COP/U.M.', 'Description of supplied materials, for each item', 'UNITARY \nPRICE ', 'TOTAL', 'UNITARY \nPRICE ', 'TOTAL', '', '', '', '', ''], reasoning=["Exact keyword matches: 'Item' exactly matches code, 'Reference' exactly matches code, 'DESCRIPTION' exactly matches description", 'Multiple exact keyword matches: 16 keywords found']
2025-11-13 12:26:00,899 [DEBUG] core.column_mapper: Row 2 (_detect_by_data_patterns): confidence=1.00, headers=['Item', 'Reference', 'DESCRIPTION', 'Measurement \nUnit', 'ESTIMATED \nQUANTITY', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'Main equipment used for works, for each item', 'COP/U.M.', 'Description of supplied materials, for each item', 'UNITARY \nPRICE ', 'TOTAL', 'UNITARY \nPRICE ', 'TOTAL', '', '', '', '', ''], reasoning=['Row contains mostly text', 'Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-11-13 12:26:00,899 [DEBUG] core.column_mapper: Row 2 (_detect_by_positional_logic): confidence=0.50, headers=['Item', 'Reference', 'DESCRIPTION', 'Measurement \nUnit', 'ESTIMATED \nQUANTITY', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'ORE/U.M.', 'COP/Hour', 'COP/U.M.', 'Main equipment used for works, for each item', 'COP/U.M.', 'Description of supplied materials, for each item', 'UNITARY \nPRICE ', 'TOTAL', 'UNITARY \nPRICE ', 'TOTAL', '', '', '', '', ''], reasoning=['Left column contains description-like content', 'Middle columns contain quantity/unit content (6 matches)']
2025-11-13 12:26:00,899 [DEBUG] core.column_mapper: Row 3 (_detect_by_data_patterns): confidence=0.70, headers=['G1', '', 'GENERAL', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-11-13 12:26:00,900 [DEBUG] core.column_mapper: Row 4 (_detect_by_data_patterns): confidence=0.70, headers=['G1.1', 'SOW', 'CIAO', 'set', '1', '', '', '120482.256', '', '', '0', '', '', '', '120482.256', '120482.256', '', '', '', 'W', 'B', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-11-13 12:26:00,900 [DEBUG] core.column_mapper: Row 16 (_detect_by_data_patterns): confidence=0.70, headers=['G5', '', 'ENVIRONMENTAL', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-11-13 12:26:00,900 [DEBUG] core.column_mapper: Row 17 (_detect_by_data_patterns): confidence=0.70, headers=['G5.1', 'SOW\n(and Permits)', 'Execution of the environmental works, environmental Mitigation and Restoration Works', 'set', '1', '', '', '500166.89600000007', '', '', '0', '', '', '', '', '', '2000667584.0000002', '2000667584.0000002', '', 'W', 'B', 'Only the felling of trees and the inherent to the construction are considered', ''], reasoning=['Subsequent rows contain numeric data in 2 rows', 'Currency patterns detected in 1 columns']
2025-11-13 12:26:00,900 [DEBUG] core.column_mapper: Row 18 (_detect_by_data_patterns): confidence=0.70, headers=['G6', '', 'SITE CAMP', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''], reasoning=['Subsequent rows contain numeric data in 3 rows', 'Currency patterns detected in 1 columns']
2025-11-13 12:26:00,901 [INFO] core.column_mapper: Header row found at index 2 with confidence 1.00
2025-11-13 12:26:00,901 [INFO] core.column_mapper: Applying consistent enhancement logic to auto-detected header row 2
2025-11-13 12:26:00,901 [INFO] core.column_mapper: Processing sheet mapping with forced header row 2 for 59 rows
2025-11-13 12:26:00,901 [DEBUG] core.column_mapper: Mapping 23 columns to BOQ types (canonical only)
2025-11-13 12:26:00,902 [DEBUG] core.column_mapper: Demoted column 'Reference' from code to ignore (duplicate required column)
2025-11-13 12:26:00,902 [DEBUG] core.column_mapper: Demoted column 'UNITARY 
PRICE' from unit_price to ignore (duplicate required column)
2025-11-13 12:26:00,902 [DEBUG] core.column_mapper: Demoted column 'TOTAL' from total_price to ignore (duplicate required column)
2025-11-13 12:26:00,902 [DEBUG] core.column_mapper: Overall mapping confidence: 0.26
2025-11-13 12:26:00,902 [INFO] core.column_mapper: Forced header mapping completed: 23 columns mapped, confidence: 0.26
2025-11-13 12:26:00,903 [INFO] core.row_classifier: Classifying 59 rows
2025-11-13 12:26:00,914 [INFO] core.row_classifier: Classification completed: {<RowType.PRIMARY_LINE_ITEM: 'primary_line_item'>: 10, <RowType.HEADER_SECTION_BREAK: 'header_section_break'>: 0, <RowType.SUBTOTAL_ROW: 'subtotal_row'>: 0, <RowType.NOTES_COMMENTS: 'notes_comments'>: 0, <RowType.BLANK_SEPARATOR: 'blank_separator'>: 0, <RowType.INVALID_LINE_ITEM: 'invalid_line_item'>: 49}
2025-11-13 12:26:00,916 [INFO] core.mapping_generator: Generating unified file mapping structure
2025-11-13 12:26:00,917 [INFO] core.mapping_generator: File mapping generated successfully: 1 sheets, global confidence: 0.49
2025-11-13 12:26:00,918 [INFO] root: File processing completed: C:\Users\Admin\Desktop\Anexo 5.1 GRE.EEC.C.00.CO.P.11002.12.017.01 BoQ PV Valledupar 4_EIFFAGE.xlsx
2025-11-13 12:26:00,918 [DEBUG] ui.main_window: Applied sheet type 'BOQ' to sheet 'General'
2025-11-13 12:26:00,920 [INFO] ui.main_window: Processing complete for file: C:/Users/Admin/Desktop/Anexo 5.1 GRE.EEC.C.00.CO.P.11002.12.017.01 BoQ PV Valledupar 4_EIFFAGE.xlsx
2025-11-13 12:26:00,920 [DEBUG] ui.main_window: Original offer_info: {'offer_name': 'aaa', 'project_name': '', 'project_size': '', 'date': '2025-11-13', 'timestamp': '2025-11-13 12:25:47'}
2025-11-13 12:26:00,920 [DEBUG] ui.main_window: Enhanced offer_info: {'offer_name': 'aaa', 'project_name': '', 'project_size': '', 'date': '2025-11-13'}
2025-11-13 12:26:00,921 [DEBUG] ui.main_window: Stored offer info for offer_name 'aaa': {'offer_name': 'aaa', 'project_name': '', 'project_size': '', 'date': '2025-11-13'}
2025-11-13 12:26:00,921 [DEBUG] ui.main_window: Stored offer info directly in file_mapping: {'offer_name': 'aaa', 'project_name': '', 'project_size': '', 'date': '2025-11-13'}
2025-11-13 12:26:00,921 [DEBUG] ui.main_window: Stored current_file_mapping reference
2025-11-13 12:26:00,929 [DEBUG] ui.main_window: Calling centralized summary grid refresh
2025-11-13 12:26:00,929 [DEBUG] ui.main_window: Summary grid refresh called
