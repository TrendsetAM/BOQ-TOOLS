# Column Letter Mapping Display Plan

## Context
- The column mapping dialog in `ui/main_window.py` currently lists mappings with headers like `Item`, `DESCRIPTION`, etc., but it does not expose the original Excel column position.
- Users want an additional leading column in this dialog that shows the original Excel column letter (e.g., `A`, `B`) to help verify mappings against the source file.
- This visual aid must exist only within the dialog; the underlying mapping data structures and exported datasets must remain unchanged.

## Targeted Files
- `ui/main_window.py`: defines the column mapping treeview within `_populate_sheet_tab` and controls how each mapping row is rendered.
- `utils/format_utils.py` (or a new lightweight utility): candidate location for a reusable helper that converts a zero-based or one-based column index into an Excel-style column label.
- Optional review of `core/mapping_generator.py` / `core/column_mapper.py`: confirm whether `column_index` values are zero-based to ensure the conversion helper produces the correct letter.

## Implementation Steps
1. **Column Index Normalization**
   - Inspect a representative `sheet.column_mappings` instance (e.g., during debugging or by logging) to confirm whether `column_index` is zero-based (likely, given existing `f"Col {col_index}"` output) or one-based.
   - Document the assumption in code comments to prevent future regressions.

2. **Helper for Column Letters**
   - Add a pure function that maps an integer column index to an Excel column letter (`0 -> A`, `25 -> Z`, `26 -> AA`, etc.).
   - Place it in `utils/format_utils.py` to keep UI logic clean and make the helper available elsewhere if needed.

3. **Treeview Column Definition Update**
   - In `_populate_sheet_tab`, prepend a new column (e.g., `Column Letter`) to the tuple passed to `ttk.Treeview`.
   - Adjust `heading` and `column` setups so widths account for the new leading column without breaking layout.

4. **Row Population Update**
   - When iterating through `sheet.column_mappings`, compute the Excel letter from `mapping.column_index` via the new helper.
   - Insert rows with the letter as the first value, followed by the existing header, mapped type, confidence, required flag, and actions.
   - Ensure existing tag logic for highlighting required columns remains intact.

5. **Scope Guarding**
   - Verify no other dialogs (e.g., the preview dialogâ€™s mapping tab) reuse the same treeview configuration; if they do and should remain unchanged, keep the helper but limit UI alterations to the main dialog.
   - Confirm that the dataset serialization/export paths (`mapping_generator`, `export` utilities) do not consume the new column, preserving existing data flows.

6. **Validation**
   - Run the UI manually to confirm the column letter appears and sorting/scrolling still function.
   - Spot-check that confirming mappings or exporting datasets behaves as before, ensuring the additional UI column has no side effects.


